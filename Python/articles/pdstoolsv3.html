<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="API Reference" href="../autoapi/index.html" /><link rel="prev" title="Additional References" href="../reference.html" />

    <link rel="shortcut icon" href="../_static/pegasystems-inc-vector-logo.svg"/><!-- Generated with Sphinx 7.3.7 and Furo 2024.05.06 -->
        <title>pdstools version 3: Polars - pdstools</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=387cc868" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>

</head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" /
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">pdstools</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/pegasystems-inc-vector-logo.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">pdstools</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/pegasystems/pega-datascientist-tools/wiki#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/pegasystems/pega-datascientist-tools/wiki">Getting Started</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/pegasystems/pega-datascientist-tools/wiki/ADM-Health-Check">ADM Health Check</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Example_ADM_Analysis.html">Example ADM analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="ADMBinningInsights.html">Insights from ADM Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="AGBModelVisualisation.html">Analyzing ADM AGB models</a></li>
<li class="toctree-l1"><a class="reference internal" href="vf_analysis.html">Value Finder analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example_Data_Anonymization.html">Data Anonymization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Articles</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="thompsonsampling.html">Thompson Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="ADMExplained.html">ADM Explained</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference Information</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../reference.html">Additional References</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Additional References</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">pdstools version 3: Polars</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/pegasystems/pega-datascientist-tools/releases">Changelog</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/pegasystems/pega-datascientist-tools">GitHub Repository</a></li>
<li class="toctree-l2"><a class="reference external" href="https://pegasystems.github.io/pega-datascientist-tools/R/index.html">R Documentation</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../autoapi/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/pdstools/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of pdstools</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/pdstools/adm/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.adm</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of pdstools.adm</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/adm/ADMDatamart/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.adm.ADMDatamart</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/adm/ADMTrees/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.adm.ADMTrees</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/adm/BinAggregator/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.adm.BinAggregator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/adm/Tables/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.adm.Tables</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/pdstools/app/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.app</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of pdstools.app</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../autoapi/pdstools/app/pages/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.app.pages</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of pdstools.app.pages</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/app/Home/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.app.Home</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/app/cli/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.app.cli</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/pdstools/ih/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.ih</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of pdstools.ih</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/ih/IHAnalysis/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.ih.IHAnalysis</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/ih/legacy_IH/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.ih.legacy_IH</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/pdstools/pega_io/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.pega_io</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of pdstools.pega_io</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/pega_io/API/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.pega_io.API</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/pega_io/File/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.pega_io.File</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/pega_io/S3/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.pega_io.S3</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/pdstools/plots/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.plots</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of pdstools.plots</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/plots/plot_base/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.plots.plot_base</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/plots/plots_plotly/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.plots.plots_plotly</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/pdstools/prediction/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.prediction</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of pdstools.prediction</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/prediction/Prediction/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.prediction.Prediction</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/pdstools/reports/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.reports</span></code></a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/pdstools/utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.utils</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of pdstools.utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/utils/CDHLimits/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.utils.CDHLimits</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/utils/NBAD/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.utils.NBAD</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/utils/cdh_utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.utils.cdh_utils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/utils/datasets/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.utils.datasets</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/utils/errors/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.utils.errors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/utils/hds_utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.utils.hds_utils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/utils/hds_utils_experimental/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.utils.hds_utils_experimental</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/utils/pega_template/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.utils.pega_template</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/utils/polars_ext/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.utils.polars_ext</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/utils/show_versions/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.utils.show_versions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/utils/streamlit_utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.utils.streamlit_utils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/utils/table_definitions/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.utils.table_definitions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/utils/types/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.utils.types</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/pdstools/valuefinder/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.valuefinder</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of pdstools.valuefinder</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/pdstools/valuefinder/ValueFinder/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdstools.valuefinder.ValueFinder</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/articles/pdstoolsv3.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="pdstools-version-3:-Polars">
<h1>pdstools version 3: Polars<a class="headerlink" href="#pdstools-version-3:-Polars" title="Link to this heading">¶</a></h1>
<p>With the version 3 release of pdstools, the back-end of the libary has shifted to use <a class="reference external" href="https://github.com/pola-rs/polars">Polars</a>. Polars is a blazingly fast DataFrames library implemented in Rust using Apache Arrow Columnar Format as the memory model. This means faster analyses and a more robust API: both externally and internally within our library. However, it is not a minor change, and will change the way you interact with the library. This article goes over some of the most notable
changes, and most importantly: best practices.</p>
<p>First off:</p>
<section id="Lazy-execution-graphs">
<h2>Lazy execution graphs<a class="headerlink" href="#Lazy-execution-graphs" title="Link to this heading">¶</a></h2>
<p>One of the, if not the single most powerful feature of Polars is its <code class="docutils literal notranslate"><span class="pre">lazy</span> <span class="pre">execution</span> <span class="pre">API</span></code>. This allows you to iteratively build up your query, have Polars optimise it for you, and only <code class="docutils literal notranslate"><span class="pre">collect</span></code> the data after your entire query. In practice, this means that all row-wise filters &amp; column-wise selects are shifted right to whenever you read the file, and all computations are optimised further. Let’s look at an example, and one close to home!</p>
<p>If we simply read in the shipped CDHSample dataset, and pass in the keyword <code class="docutils literal notranslate"><span class="pre">import_strategy='lazy'</span></code>, it will allow us to demonstrate this effect. Note: by default the import strategy is <code class="docutils literal notranslate"><span class="pre">'eager'</span></code>. We’ll get to that later.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pdstools</span> <span class="kn">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">ADMDatamart</span>
<span class="kn">import</span> <span class="nn">polars</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="n">dm</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CDHSample</span><span class="p">(</span><span class="n">import_strategy</span><span class="o">=</span><span class="s1">&#39;lazy&#39;</span><span class="p">)</span>
<span class="n">dm</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;pdstools.adm.ADMDatamart.ADMDatamart at 0x7f5d29825150&gt;
</pre></div></div>
</div>
<p>If you’ve used the previous version of pdstools, you’ve probably noticed nothing’s changed. You still get the same <code class="docutils literal notranslate"><span class="pre">ADMDatamart</span></code> object.</p>
<p>Try accessing the <code class="docutils literal notranslate"><span class="pre">modelData</span></code>, <code class="docutils literal notranslate"><span class="pre">predictorData</span></code> or <code class="docutils literal notranslate"><span class="pre">combinedData</span></code> property however, and things are different.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm</span><span class="o">.</span><span class="n">modelData</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<h4>NAIVE QUERY PLAN</h4><p>run <b>LazyFrame.show_graph()</b> to see the optimized version</p><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: polars_query Pages: 1 -->
<svg width="883pt" height="349pt"
 viewBox="0.00 0.00 883.00 349.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 345)">
<title>polars_query</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-345 879,-345 879,4 -4,4"/>
<!-- WITH COLUMNS [&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;] [(0, 0)] -->
<g id="node1" class="node">
<title>WITH COLUMNS [&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;] [(0, 0)]</title>
<polygon fill="none" stroke="black" points="709.5,-341 165.5,-341 165.5,-305 709.5,-305 709.5,-341"/>
<text text-anchor="middle" x="437.5" y="-319.3" font-family="Times,serif" font-size="14.00">WITH COLUMNS [&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;]</text>
</g>
<!-- WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;] [(0, 1)] -->
<g id="node2" class="node">
<title>WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;] [(0, 1)]</title>
<polygon fill="none" stroke="black" points="875,-269 0,-269 0,-233 875,-233 875,-269"/>
<text text-anchor="middle" x="437.5" y="-247.3" font-family="Times,serif" font-size="14.00">WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;]</text>
</g>
<!-- WITH COLUMNS [&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;] [(0, 0)]&#45;&#45;WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;] [(0, 1)] -->
<g id="edge1" class="edge">
<title>WITH COLUMNS [&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;] [(0, 0)]&#45;&#45;WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;] [(0, 1)]</title>
<path fill="none" stroke="black" d="M437.5,-304.7C437.5,-293.85 437.5,-279.92 437.5,-269.1"/>
</g>
<!-- π 12/27 [(0, 2)] -->
<g id="node3" class="node">
<title>π 12/27 [(0, 2)]</title>
<polygon fill="none" stroke="black" points="473,-197 402,-197 402,-161 473,-161 473,-197"/>
<text text-anchor="middle" x="437.5" y="-175.3" font-family="Times,serif" font-size="14.00">π 12/27</text>
</g>
<!-- WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;] [(0, 1)]&#45;&#45;π 12/27 [(0, 2)] -->
<g id="edge2" class="edge">
<title>WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;] [(0, 1)]&#45;&#45;π 12/27 [(0, 2)]</title>
<path fill="none" stroke="black" d="M437.5,-232.7C437.5,-221.85 437.5,-207.92 437.5,-197.1"/>
</g>
<!-- RENAME [(0, 3)] -->
<g id="node4" class="node">
<title>RENAME [(0, 3)]</title>
<polygon fill="none" stroke="black" points="479.5,-125 395.5,-125 395.5,-89 479.5,-89 479.5,-125"/>
<text text-anchor="middle" x="437.5" y="-103.3" font-family="Times,serif" font-size="14.00">RENAME</text>
</g>
<!-- π 12/27 [(0, 2)]&#45;&#45;RENAME [(0, 3)] -->
<g id="edge3" class="edge">
<title>π 12/27 [(0, 2)]&#45;&#45;RENAME [(0, 3)]</title>
<path fill="none" stroke="black" d="M437.5,-160.7C437.5,-149.85 437.5,-135.92 437.5,-125.1"/>
</g>
<!-- TABLE
π */27;
σ &#45; [(0, 4)] -->
<g id="node5" class="node">
<title>TABLE
π */27;
σ &#45; [(0, 4)]</title>
<polygon fill="none" stroke="black" points="470,-53 405,-53 405,0 470,0 470,-53"/>
<text text-anchor="middle" x="437.5" y="-37.8" font-family="Times,serif" font-size="14.00">TABLE</text>
<text text-anchor="middle" x="437.5" y="-22.8" font-family="Times,serif" font-size="14.00">π */27;</text>
<text text-anchor="middle" x="437.5" y="-7.8" font-family="Times,serif" font-size="14.00">σ &#45;</text>
</g>
<!-- RENAME [(0, 3)]&#45;&#45;TABLE
π */27;
σ &#45; [(0, 4)] -->
<g id="edge4" class="edge">
<title>RENAME [(0, 3)]&#45;&#45;TABLE
π */27;
σ &#45; [(0, 4)]</title>
<path fill="none" stroke="black" d="M437.5,-88.97C437.5,-78.51 437.5,-64.9 437.5,-53.16"/>
</g>
</g>
</svg></div>
</div>
<p>Not a dataframe - but a <code class="docutils literal notranslate"><span class="pre">NAIVE</span> <span class="pre">QUERY</span> <span class="pre">PLAN</span></code>. It’s relatively intuitive, but you’d read this chart bottom-to-top:</p>
<ul class="simple">
<li><p>We read the table, <span class="math notranslate nohighlight">\(\pi\)</span> <code class="docutils literal notranslate"><span class="pre">*/27;</span></code> (reading all columns out of the 27 available) and <span class="math notranslate nohighlight">\(\sigma\)</span> <code class="docutils literal notranslate"><span class="pre">-;</span></code> (no row-wise filters applied).</p></li>
<li><p>We then rename the columns by a predefined manner</p></li>
<li><p>Then we only keep 12 out of the 27 available columns</p></li>
<li><p>Change <code class="docutils literal notranslate"><span class="pre">[&quot;Issue&quot;,&quot;Group&quot;,&quot;Channel&quot;,&quot;Direction&quot;,&quot;Configuration&quot;]</span></code> to be categorical, <code class="docutils literal notranslate"><span class="pre">&quot;Performance&quot;</span></code> to numeric.</p></li>
<li><p>Transform <code class="docutils literal notranslate"><span class="pre">&quot;SnapshotTime&quot;</span></code> to datetime</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">[&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;]</span></code> as columns.</p></li>
</ul>
<p>A sharp eye might already notice an inefficiency here. If we first read in all columns, then rename and then filter, can’t we already infer which columns we need based on our predefined function, and filter when reading? Well - yes!</p>
<p>This is the <code class="docutils literal notranslate"><span class="pre">naive</span></code> plan. If we call <code class="docutils literal notranslate"><span class="pre">.show_graph()</span></code>, we get the optimized version:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm</span><span class="o">.</span><span class="n">modelData</span><span class="o">.</span><span class="n">show_graph</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/articles_pdstoolsv3_6_0.svg" src="../_images/articles_pdstoolsv3_6_0.svg" /></div>
</div>
<p>At first glance; not a huge change. However, note at the bottom we import <span class="math notranslate nohighlight">\(\pi\)</span> <code class="docutils literal notranslate"><span class="pre">12/27;</span></code>: we filter right when reading the file, and only read in 12 columns! This can make a big difference, especially because one column (<code class="docutils literal notranslate"><span class="pre">&quot;pyModelData&quot;</span></code>) is very big.</p>
<p>Thus far, the <span class="math notranslate nohighlight">\(\sigma\)</span> symbol has been <code class="docutils literal notranslate"><span class="pre">-</span></code>. We can also change that: the <span class="math notranslate nohighlight">\(\sigma\)</span> symbol shows you which filters it applies on the rows when it’s reading. For our example purpose, Let’s say we’re only interested in actions containing <code class="docutils literal notranslate"><span class="pre">Visa</span></code>. We can add that filter right to our execution plan!</p>
<p>To tell Polars we’re trying to filter on a <code class="docutils literal notranslate"><span class="pre">column</span></code>, we simply start our query with <code class="docutils literal notranslate"><span class="pre">pl.col(&quot;Name&quot;)</span></code>. The <code class="docutils literal notranslate"><span class="pre">Name</span></code> column, containing the action names, is a string column. Therefore, to access <code class="docutils literal notranslate"><span class="pre">string</span></code>-based operations, we simply use <code class="docutils literal notranslate"><span class="pre">.str</span></code> to go to the <code class="docutils literal notranslate"><span class="pre">string</span> <span class="pre">namespace</span></code>. We want the string to <code class="docutils literal notranslate"><span class="pre">contain</span></code> <code class="docutils literal notranslate"><span class="pre">Visa</span></code>, therefore: <code class="docutils literal notranslate"><span class="pre">query=pl.col(&quot;Name&quot;).str.contains(&quot;Visa&quot;)</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CDHSample</span><span class="p">(</span>
    <span class="n">import_strategy</span><span class="o">=</span><span class="s2">&quot;lazy&quot;</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;Visa&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">dm</span><span class="o">.</span><span class="n">modelData</span><span class="o">.</span><span class="n">show_graph</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/articles_pdstoolsv3_8_0.svg" src="../_images/articles_pdstoolsv3_8_0.svg" /></div>
</div>
<p>“Okay, but how do we actually get to the data?” - Simple! Just use <code class="docutils literal notranslate"><span class="pre">.collect()</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm</span><span class="o">.</span><span class="n">modelData</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (22, 15)</small><table border="1" class="dataframe"><thead><tr><th>Group</th><th>Performance</th><th>Treatment</th><th>Channel</th><th>ResponseCount</th><th>Direction</th><th>Name</th><th>ModelID</th><th>SnapshotTime</th><th>Configuration</th><th>Issue</th><th>Positives</th><th>SuccessRate</th><th>Last_Positives</th><th>Last_ResponseCount</th></tr><tr><td>cat</td><td>f64</td><td>null</td><td>cat</td><td>f32</td><td>cat</td><td>str</td><td>str</td><td>datetime[ns]</td><td>cat</td><td>cat</td><td>f32</td><td>f32</td><td>datetime[ns]</td><td>datetime[ns]</td></tr></thead><tbody><tr><td>&quot;CreditCards&quot;</td><td>0.5</td><td>null</td><td>&quot;Web&quot;</td><td>72.0</td><td>&quot;Inbound&quot;</td><td>&quot;VisaGold&quot;</td><td>&quot;17571d69-f802-5122-9bfe-6f3f4e…</td><td>2021-06-01 08:23:26.789</td><td>&quot;OmniAdaptiveModel&quot;</td><td>&quot;Sales&quot;</td><td>1.0</td><td>0.013889</td><td>2021-06-01 13:23:26.789</td><td>2021-06-01 13:23:26.789</td></tr><tr><td>&quot;CreditCards&quot;</td><td>0.5</td><td>null</td><td>&quot;SMS&quot;</td><td>166.0</td><td>&quot;Outbound&quot;</td><td>&quot;VisaGold&quot;</td><td>&quot;1be7cd72-741b-5d68-b148-c1af01…</td><td>2021-06-01 08:23:26.789</td><td>&quot;OmniAdaptiveModel&quot;</td><td>&quot;Sales&quot;</td><td>4.0</td><td>0.024096</td><td>2021-06-01 13:23:26.789</td><td>2021-06-01 13:23:26.789</td></tr><tr><td>&quot;CreditCards&quot;</td><td>0.5</td><td>null</td><td>&quot;Web&quot;</td><td>161.0</td><td>&quot;Inbound&quot;</td><td>&quot;VisaGold&quot;</td><td>&quot;17571d69-f802-5122-9bfe-6f3f4e…</td><td>2021-06-01 08:27:55.789</td><td>&quot;OmniAdaptiveModel&quot;</td><td>&quot;Sales&quot;</td><td>3.0</td><td>0.018634</td><td>2021-06-01 13:23:26.789</td><td>2021-06-01 13:23:26.789</td></tr><tr><td>&quot;CreditCards&quot;</td><td>0.5</td><td>null</td><td>&quot;Web&quot;</td><td>161.0</td><td>&quot;Inbound&quot;</td><td>&quot;VisaGold&quot;</td><td>&quot;17571d69-f802-5122-9bfe-6f3f4e…</td><td>2021-06-01 09:03:01.789</td><td>&quot;OmniAdaptiveModel&quot;</td><td>&quot;Sales&quot;</td><td>3.0</td><td>0.018634</td><td>2021-06-01 13:23:26.789</td><td>2021-06-01 13:23:26.789</td></tr><tr><td>&quot;CreditCards&quot;</td><td>0.5</td><td>null</td><td>&quot;SMS&quot;</td><td>166.0</td><td>&quot;Outbound&quot;</td><td>&quot;VisaGold&quot;</td><td>&quot;1be7cd72-741b-5d68-b148-c1af01…</td><td>2021-06-01 09:03:01.789</td><td>&quot;OmniAdaptiveModel&quot;</td><td>&quot;Sales&quot;</td><td>4.0</td><td>0.024096</td><td>2021-06-01 13:23:26.789</td><td>2021-06-01 13:23:26.789</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>&quot;CreditCards&quot;</td><td>0.524312</td><td>null</td><td>&quot;SMS&quot;</td><td>674.0</td><td>&quot;Outbound&quot;</td><td>&quot;VisaGold&quot;</td><td>&quot;1be7cd72-741b-5d68-b148-c1af01…</td><td>2021-06-01 12:42:04.789</td><td>&quot;OmniAdaptiveModel&quot;</td><td>&quot;Sales&quot;</td><td>21.0</td><td>0.031157</td><td>2021-06-01 13:23:26.789</td><td>2021-06-01 13:23:26.789</td></tr><tr><td>&quot;CreditCards&quot;</td><td>0.535621</td><td>null</td><td>&quot;SMS&quot;</td><td>746.0</td><td>&quot;Outbound&quot;</td><td>&quot;VisaGold&quot;</td><td>&quot;1be7cd72-741b-5d68-b148-c1af01…</td><td>2021-06-01 12:45:20.789</td><td>&quot;OmniAdaptiveModel&quot;</td><td>&quot;Sales&quot;</td><td>24.0</td><td>0.032172</td><td>2021-06-01 13:23:26.789</td><td>2021-06-01 13:23:26.789</td></tr><tr><td>&quot;CreditCards&quot;</td><td>0.538104</td><td>null</td><td>&quot;Web&quot;</td><td>706.0</td><td>&quot;Inbound&quot;</td><td>&quot;VisaGold&quot;</td><td>&quot;17571d69-f802-5122-9bfe-6f3f4e…</td><td>2021-06-01 13:18:21.789</td><td>&quot;OmniAdaptiveModel&quot;</td><td>&quot;Sales&quot;</td><td>43.0</td><td>0.060907</td><td>2021-06-01 13:23:26.789</td><td>2021-06-01 13:23:26.789</td></tr><tr><td>&quot;CreditCards&quot;</td><td>0.531863</td><td>null</td><td>&quot;SMS&quot;</td><td>822.0</td><td>&quot;Outbound&quot;</td><td>&quot;VisaGold&quot;</td><td>&quot;1be7cd72-741b-5d68-b148-c1af01…</td><td>2021-06-01 13:23:26.789</td><td>&quot;OmniAdaptiveModel&quot;</td><td>&quot;Sales&quot;</td><td>27.0</td><td>0.032847</td><td>2021-06-01 13:23:26.789</td><td>2021-06-01 13:23:26.789</td></tr><tr><td>&quot;CreditCards&quot;</td><td>0.519586</td><td>null</td><td>&quot;Web&quot;</td><td>778.0</td><td>&quot;Inbound&quot;</td><td>&quot;VisaGold&quot;</td><td>&quot;17571d69-f802-5122-9bfe-6f3f4e…</td><td>2021-06-01 13:23:26.789</td><td>&quot;OmniAdaptiveModel&quot;</td><td>&quot;Sales&quot;</td><td>46.0</td><td>0.059126</td><td>2021-06-01 13:23:26.789</td><td>2021-06-01 13:23:26.789</td></tr></tbody></table></div></div>
</div>
<p>This table is very similar to Pandas tables, though there are some slight differences. The types are explicitly mentioned in the header, string values are in quotes, and long string values get cut off more agressively. Other than that, there’s no real change! And if you still want to use pandas, just call <code class="docutils literal notranslate"><span class="pre">.to_pandas()</span></code> :)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm</span><span class="o">.</span><span class="n">modelData</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Group</th>
      <th>Performance</th>
      <th>Treatment</th>
      <th>Channel</th>
      <th>ResponseCount</th>
      <th>Direction</th>
      <th>Name</th>
      <th>ModelID</th>
      <th>SnapshotTime</th>
      <th>Configuration</th>
      <th>Issue</th>
      <th>Positives</th>
      <th>SuccessRate</th>
      <th>Last_Positives</th>
      <th>Last_ResponseCount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CreditCards</td>
      <td>0.500000</td>
      <td>None</td>
      <td>Web</td>
      <td>72.0</td>
      <td>Inbound</td>
      <td>VisaGold</td>
      <td>17571d69-f802-5122-9bfe-6f3f4ef9073b</td>
      <td>2021-06-01 08:23:26.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>1.0</td>
      <td>0.013889</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CreditCards</td>
      <td>0.500000</td>
      <td>None</td>
      <td>SMS</td>
      <td>166.0</td>
      <td>Outbound</td>
      <td>VisaGold</td>
      <td>1be7cd72-741b-5d68-b148-c1af0142fd4a</td>
      <td>2021-06-01 08:23:26.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>4.0</td>
      <td>0.024096</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CreditCards</td>
      <td>0.500000</td>
      <td>None</td>
      <td>Web</td>
      <td>161.0</td>
      <td>Inbound</td>
      <td>VisaGold</td>
      <td>17571d69-f802-5122-9bfe-6f3f4ef9073b</td>
      <td>2021-06-01 08:27:55.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>3.0</td>
      <td>0.018634</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CreditCards</td>
      <td>0.500000</td>
      <td>None</td>
      <td>Web</td>
      <td>161.0</td>
      <td>Inbound</td>
      <td>VisaGold</td>
      <td>17571d69-f802-5122-9bfe-6f3f4ef9073b</td>
      <td>2021-06-01 09:03:01.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>3.0</td>
      <td>0.018634</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CreditCards</td>
      <td>0.500000</td>
      <td>None</td>
      <td>SMS</td>
      <td>166.0</td>
      <td>Outbound</td>
      <td>VisaGold</td>
      <td>1be7cd72-741b-5d68-b148-c1af0142fd4a</td>
      <td>2021-06-01 09:03:01.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>4.0</td>
      <td>0.024096</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>5</th>
      <td>CreditCards</td>
      <td>0.500000</td>
      <td>None</td>
      <td>SMS</td>
      <td>271.0</td>
      <td>Outbound</td>
      <td>VisaGold</td>
      <td>1be7cd72-741b-5d68-b148-c1af0142fd4a</td>
      <td>2021-06-01 09:06:33.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>7.0</td>
      <td>0.025830</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>6</th>
      <td>CreditCards</td>
      <td>0.554538</td>
      <td>None</td>
      <td>Web</td>
      <td>233.0</td>
      <td>Inbound</td>
      <td>VisaGold</td>
      <td>17571d69-f802-5122-9bfe-6f3f4ef9073b</td>
      <td>2021-06-01 09:06:33.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>12.0</td>
      <td>0.051502</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>7</th>
      <td>CreditCards</td>
      <td>0.554538</td>
      <td>None</td>
      <td>Web</td>
      <td>233.0</td>
      <td>Inbound</td>
      <td>VisaGold</td>
      <td>17571d69-f802-5122-9bfe-6f3f4ef9073b</td>
      <td>2021-06-01 09:34:34.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>12.0</td>
      <td>0.051502</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>8</th>
      <td>CreditCards</td>
      <td>0.500000</td>
      <td>None</td>
      <td>SMS</td>
      <td>353.0</td>
      <td>Outbound</td>
      <td>VisaGold</td>
      <td>1be7cd72-741b-5d68-b148-c1af0142fd4a</td>
      <td>2021-06-01 09:43:16.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>8.0</td>
      <td>0.022663</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>9</th>
      <td>CreditCards</td>
      <td>0.541487</td>
      <td>None</td>
      <td>Web</td>
      <td>320.0</td>
      <td>Inbound</td>
      <td>VisaGold</td>
      <td>17571d69-f802-5122-9bfe-6f3f4ef9073b</td>
      <td>2021-06-01 09:43:16.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>19.0</td>
      <td>0.059375</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>10</th>
      <td>CreditCards</td>
      <td>0.500000</td>
      <td>None</td>
      <td>SMS</td>
      <td>437.0</td>
      <td>Outbound</td>
      <td>VisaGold</td>
      <td>1be7cd72-741b-5d68-b148-c1af0142fd4a</td>
      <td>2021-06-01 10:07:35.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>10.0</td>
      <td>0.022883</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>11</th>
      <td>CreditCards</td>
      <td>0.557512</td>
      <td>None</td>
      <td>Web</td>
      <td>391.0</td>
      <td>Inbound</td>
      <td>VisaGold</td>
      <td>17571d69-f802-5122-9bfe-6f3f4ef9073b</td>
      <td>2021-06-01 10:07:35.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>24.0</td>
      <td>0.061381</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>12</th>
      <td>CreditCards</td>
      <td>0.531173</td>
      <td>None</td>
      <td>Web</td>
      <td>470.0</td>
      <td>Inbound</td>
      <td>VisaGold</td>
      <td>17571d69-f802-5122-9bfe-6f3f4ef9073b</td>
      <td>2021-06-01 10:58:26.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>28.0</td>
      <td>0.059574</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>13</th>
      <td>CreditCards</td>
      <td>0.551713</td>
      <td>None</td>
      <td>SMS</td>
      <td>507.0</td>
      <td>Outbound</td>
      <td>VisaGold</td>
      <td>1be7cd72-741b-5d68-b148-c1af0142fd4a</td>
      <td>2021-06-01 10:58:26.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>17.0</td>
      <td>0.033531</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>14</th>
      <td>CreditCards</td>
      <td>0.551713</td>
      <td>None</td>
      <td>SMS</td>
      <td>507.0</td>
      <td>Outbound</td>
      <td>VisaGold</td>
      <td>1be7cd72-741b-5d68-b148-c1af0142fd4a</td>
      <td>2021-06-01 11:29:54.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>17.0</td>
      <td>0.033531</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>15</th>
      <td>CreditCards</td>
      <td>0.524312</td>
      <td>None</td>
      <td>SMS</td>
      <td>674.0</td>
      <td>Outbound</td>
      <td>VisaGold</td>
      <td>1be7cd72-741b-5d68-b148-c1af0142fd4a</td>
      <td>2021-06-01 12:15:05.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>21.0</td>
      <td>0.031157</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>16</th>
      <td>CreditCards</td>
      <td>0.549843</td>
      <td>None</td>
      <td>Web</td>
      <td>633.0</td>
      <td>Inbound</td>
      <td>VisaGold</td>
      <td>17571d69-f802-5122-9bfe-6f3f4ef9073b</td>
      <td>2021-06-01 12:15:05.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>39.0</td>
      <td>0.061611</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>17</th>
      <td>CreditCards</td>
      <td>0.524312</td>
      <td>None</td>
      <td>SMS</td>
      <td>674.0</td>
      <td>Outbound</td>
      <td>VisaGold</td>
      <td>1be7cd72-741b-5d68-b148-c1af0142fd4a</td>
      <td>2021-06-01 12:42:04.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>21.0</td>
      <td>0.031157</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>18</th>
      <td>CreditCards</td>
      <td>0.535621</td>
      <td>None</td>
      <td>SMS</td>
      <td>746.0</td>
      <td>Outbound</td>
      <td>VisaGold</td>
      <td>1be7cd72-741b-5d68-b148-c1af0142fd4a</td>
      <td>2021-06-01 12:45:20.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>24.0</td>
      <td>0.032172</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>19</th>
      <td>CreditCards</td>
      <td>0.538104</td>
      <td>None</td>
      <td>Web</td>
      <td>706.0</td>
      <td>Inbound</td>
      <td>VisaGold</td>
      <td>17571d69-f802-5122-9bfe-6f3f4ef9073b</td>
      <td>2021-06-01 13:18:21.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>43.0</td>
      <td>0.060907</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>20</th>
      <td>CreditCards</td>
      <td>0.531863</td>
      <td>None</td>
      <td>SMS</td>
      <td>822.0</td>
      <td>Outbound</td>
      <td>VisaGold</td>
      <td>1be7cd72-741b-5d68-b148-c1af0142fd4a</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>27.0</td>
      <td>0.032847</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
    <tr>
      <th>21</th>
      <td>CreditCards</td>
      <td>0.519586</td>
      <td>None</td>
      <td>Web</td>
      <td>778.0</td>
      <td>Inbound</td>
      <td>VisaGold</td>
      <td>17571d69-f802-5122-9bfe-6f3f4ef9073b</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>OmniAdaptiveModel</td>
      <td>Sales</td>
      <td>46.0</td>
      <td>0.059126</td>
      <td>2021-06-01 13:23:26.789</td>
      <td>2021-06-01 13:23:26.789</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Now, we don’t just have modelData, there’s also information about predictors. This is under the <code class="docutils literal notranslate"><span class="pre">predictorData</span></code> attribute, and it works the same way. Thirdly, we add a attribute called <code class="docutils literal notranslate"><span class="pre">combinedData</span></code>. <code class="docutils literal notranslate"><span class="pre">combinedData</span></code> is technically just an inner join between the model data and the predictor data on the model ID. Therefore, the model ID’s we filter out of the models also propagate to the combined data. To give more insight into this join, we can now simply show the execution graph of it:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm</span><span class="o">.</span><span class="n">combinedData</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<h4>NAIVE QUERY PLAN</h4><p>run <b>LazyFrame.show_graph()</b> to see the optimized version</p><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: polars_query Pages: 1 -->
<svg width="3015pt" height="832pt"
 viewBox="0.00 0.00 3015.00 832.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 828)">
<title>polars_query</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-828 3011,-828 3011,4 -4,4"/>
<!-- JOIN INNER
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;left: [col(&quot;ModelID&quot;)];
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;right: [col(&quot;ModelID&quot;)] [(0, 0)] -->
<g id="node1" class="node">
<title>JOIN INNER
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;left: [col(&quot;ModelID&quot;)];
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;right: [col(&quot;ModelID&quot;)] [(0, 0)]</title>
<polygon fill="none" stroke="black" points="1427.5,-824 1161.5,-824 1161.5,-771 1427.5,-771 1427.5,-824"/>
<text text-anchor="middle" x="1294.5" y="-808.8" font-family="Times,serif" font-size="14.00">JOIN INNER</text>
<text text-anchor="middle" x="1294.5" y="-793.8" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;left: [col(&quot;ModelID&quot;)];</text>
<text text-anchor="middle" x="1294.5" y="-778.8" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;right: [col(&quot;ModelID&quot;)]</text>
</g>
<!-- FILTER BY (col(&quot;SnapshotTime&quot;).fill... [(100, 1)] -->
<g id="node2" class="node">
<title>FILTER BY (col(&quot;SnapshotTime&quot;).fill... [(100, 1)]</title>
<polygon fill="none" stroke="black" points="1286,-735 1001,-735 1001,-699 1286,-699 1286,-735"/>
<text text-anchor="middle" x="1143.5" y="-713.3" font-family="Times,serif" font-size="14.00">FILTER BY (col(&quot;SnapshotTime&quot;).fill...</text>
</g>
<!-- JOIN INNER
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;left: [col(&quot;ModelID&quot;)];
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;right: [col(&quot;ModelID&quot;)] [(0, 0)]&#45;&#45;FILTER BY (col(&quot;SnapshotTime&quot;).fill... [(100, 1)] -->
<g id="edge1" class="edge">
<title>JOIN INNER
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;left: [col(&quot;ModelID&quot;)];
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;right: [col(&quot;ModelID&quot;)] [(0, 0)]&#45;&#45;FILTER BY (col(&quot;SnapshotTime&quot;).fill... [(100, 1)]</title>
<path fill="none" stroke="black" d="M1245.06,-770.8C1222.52,-759.08 1196.46,-745.53 1176.38,-735.09"/>
</g>
<!-- FILTER BY (col(&quot;SnapshotTime&quot;).fill... [(200, 1)] -->
<g id="node10" class="node">
<title>FILTER BY (col(&quot;SnapshotTime&quot;).fill... [(200, 1)]</title>
<polygon fill="none" stroke="black" points="1623,-735 1338,-735 1338,-699 1623,-699 1623,-735"/>
<text text-anchor="middle" x="1480.5" y="-713.3" font-family="Times,serif" font-size="14.00">FILTER BY (col(&quot;SnapshotTime&quot;).fill...</text>
</g>
<!-- JOIN INNER
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;left: [col(&quot;ModelID&quot;)];
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;right: [col(&quot;ModelID&quot;)] [(0, 0)]&#45;&#45;FILTER BY (col(&quot;SnapshotTime&quot;).fill... [(200, 1)] -->
<g id="edge9" class="edge">
<title>JOIN INNER
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;left: [col(&quot;ModelID&quot;)];
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;right: [col(&quot;ModelID&quot;)] [(0, 0)]&#45;&#45;FILTER BY (col(&quot;SnapshotTime&quot;).fill... [(200, 1)]</title>
<path fill="none" stroke="black" d="M1355.15,-770.9C1383.03,-759.14 1415.34,-745.5 1440.18,-735.02"/>
</g>
<!-- FILTER BY col(&quot;Name&quot;).str.contains(... [(100, 2)] -->
<g id="node3" class="node">
<title>FILTER BY col(&quot;Name&quot;).str.contains(... [(100, 2)]</title>
<polygon fill="none" stroke="black" points="1220.5,-654.5 930.5,-654.5 930.5,-618.5 1220.5,-618.5 1220.5,-654.5"/>
<text text-anchor="middle" x="1075.5" y="-632.8" font-family="Times,serif" font-size="14.00">FILTER BY col(&quot;Name&quot;).str.contains(...</text>
</g>
<!-- FILTER BY (col(&quot;SnapshotTime&quot;).fill... [(100, 1)]&#45;&#45;FILTER BY col(&quot;Name&quot;).str.contains(... [(100, 2)] -->
<g id="edge2" class="edge">
<title>FILTER BY (col(&quot;SnapshotTime&quot;).fill... [(100, 1)]&#45;&#45;FILTER BY col(&quot;Name&quot;).str.contains(... [(100, 2)]</title>
<path fill="none" stroke="black" d="M1128.75,-698.97C1117.34,-685.8 1101.62,-667.66 1090.23,-654.5"/>
</g>
<!-- WITH COLUMNS [&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;] [(100, 3)] -->
<g id="node4" class="node">
<title>WITH COLUMNS [&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;] [(100, 3)]</title>
<polygon fill="none" stroke="black" points="1241.5,-574 697.5,-574 697.5,-538 1241.5,-538 1241.5,-574"/>
<text text-anchor="middle" x="969.5" y="-552.3" font-family="Times,serif" font-size="14.00">WITH COLUMNS [&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;]</text>
</g>
<!-- FILTER BY col(&quot;Name&quot;).str.contains(... [(100, 2)]&#45;&#45;WITH COLUMNS [&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;] [(100, 3)] -->
<g id="edge3" class="edge">
<title>FILTER BY col(&quot;Name&quot;).str.contains(... [(100, 2)]&#45;&#45;WITH COLUMNS [&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;] [(100, 3)]</title>
<path fill="none" stroke="black" d="M1052.5,-618.47C1034.72,-605.3 1010.22,-587.16 992.46,-574"/>
</g>
<!-- FILTER BY col(&quot;Name&quot;).str.contains(... [(100, 4)] -->
<g id="node5" class="node">
<title>FILTER BY col(&quot;Name&quot;).str.contains(... [(100, 4)]</title>
<polygon fill="none" stroke="black" points="760.5,-502 470.5,-502 470.5,-466 760.5,-466 760.5,-502"/>
<text text-anchor="middle" x="615.5" y="-480.3" font-family="Times,serif" font-size="14.00">FILTER BY col(&quot;Name&quot;).str.contains(...</text>
</g>
<!-- WITH COLUMNS [&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;] [(100, 3)]&#45;&#45;FILTER BY col(&quot;Name&quot;).str.contains(... [(100, 4)] -->
<g id="edge4" class="edge">
<title>WITH COLUMNS [&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;] [(100, 3)]&#45;&#45;FILTER BY col(&quot;Name&quot;).str.contains(... [(100, 4)]</title>
<path fill="none" stroke="black" d="M883.35,-537.97C828.2,-527.06 756.9,-512.96 701.72,-502.05"/>
</g>
<!-- WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;] [(100, 5)] -->
<g id="node6" class="node">
<title>WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;] [(100, 5)]</title>
<polygon fill="none" stroke="black" points="875,-430 0,-430 0,-394 875,-394 875,-430"/>
<text text-anchor="middle" x="437.5" y="-408.3" font-family="Times,serif" font-size="14.00">WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;]</text>
</g>
<!-- FILTER BY col(&quot;Name&quot;).str.contains(... [(100, 4)]&#45;&#45;WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;] [(100, 5)] -->
<g id="edge5" class="edge">
<title>FILTER BY col(&quot;Name&quot;).str.contains(... [(100, 4)]&#45;&#45;WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;] [(100, 5)]</title>
<path fill="none" stroke="black" d="M571.96,-465.88C544.27,-454.99 508.56,-440.95 480.9,-430.07"/>
</g>
<!-- π 12/27 [(100, 6)] -->
<g id="node7" class="node">
<title>π 12/27 [(100, 6)]</title>
<polygon fill="none" stroke="black" points="473,-358 402,-358 402,-322 473,-322 473,-358"/>
<text text-anchor="middle" x="437.5" y="-336.3" font-family="Times,serif" font-size="14.00">π 12/27</text>
</g>
<!-- WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;] [(100, 5)]&#45;&#45;π 12/27 [(100, 6)] -->
<g id="edge6" class="edge">
<title>WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;] [(100, 5)]&#45;&#45;π 12/27 [(100, 6)]</title>
<path fill="none" stroke="black" d="M437.5,-393.7C437.5,-382.85 437.5,-368.92 437.5,-358.1"/>
</g>
<!-- RENAME [(100, 7)] -->
<g id="node8" class="node">
<title>RENAME [(100, 7)]</title>
<polygon fill="none" stroke="black" points="479.5,-286 395.5,-286 395.5,-250 479.5,-250 479.5,-286"/>
<text text-anchor="middle" x="437.5" y="-264.3" font-family="Times,serif" font-size="14.00">RENAME</text>
</g>
<!-- π 12/27 [(100, 6)]&#45;&#45;RENAME [(100, 7)] -->
<g id="edge7" class="edge">
<title>π 12/27 [(100, 6)]&#45;&#45;RENAME [(100, 7)]</title>
<path fill="none" stroke="black" d="M437.5,-321.7C437.5,-310.85 437.5,-296.92 437.5,-286.1"/>
</g>
<!-- TABLE
π */27;
σ &#45; [(100, 8)] -->
<g id="node9" class="node">
<title>TABLE
π */27;
σ &#45; [(100, 8)]</title>
<polygon fill="none" stroke="black" points="470,-214 405,-214 405,-161 470,-161 470,-214"/>
<text text-anchor="middle" x="437.5" y="-198.8" font-family="Times,serif" font-size="14.00">TABLE</text>
<text text-anchor="middle" x="437.5" y="-183.8" font-family="Times,serif" font-size="14.00">π */27;</text>
<text text-anchor="middle" x="437.5" y="-168.8" font-family="Times,serif" font-size="14.00">σ &#45;</text>
</g>
<!-- RENAME [(100, 7)]&#45;&#45;TABLE
π */27;
σ &#45; [(100, 8)] -->
<g id="edge8" class="edge">
<title>RENAME [(100, 7)]&#45;&#45;TABLE
π */27;
σ &#45; [(100, 8)]</title>
<path fill="none" stroke="black" d="M437.5,-249.97C437.5,-239.51 437.5,-225.9 437.5,-214.16"/>
</g>
<!-- JOIN INNER
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;left: [col(&quot;ModelID&quot;)];
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;right: [col(&quot;ModelID&quot;)] [(200, 2)] -->
<g id="node11" class="node">
<title>JOIN INNER
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;left: [col(&quot;ModelID&quot;)];
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;right: [col(&quot;ModelID&quot;)] [(200, 2)]</title>
<polygon fill="none" stroke="black" points="1719.5,-663 1453.5,-663 1453.5,-610 1719.5,-610 1719.5,-663"/>
<text text-anchor="middle" x="1586.5" y="-647.8" font-family="Times,serif" font-size="14.00">JOIN INNER</text>
<text text-anchor="middle" x="1586.5" y="-632.8" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;left: [col(&quot;ModelID&quot;)];</text>
<text text-anchor="middle" x="1586.5" y="-617.8" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;right: [col(&quot;ModelID&quot;)]</text>
</g>
<!-- FILTER BY (col(&quot;SnapshotTime&quot;).fill... [(200, 1)]&#45;&#45;JOIN INNER
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;left: [col(&quot;ModelID&quot;)];
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;right: [col(&quot;ModelID&quot;)] [(200, 2)] -->
<g id="edge10" class="edge">
<title>FILTER BY (col(&quot;SnapshotTime&quot;).fill... [(200, 1)]&#45;&#45;JOIN INNER
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;left: [col(&quot;ModelID&quot;)];
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;right: [col(&quot;ModelID&quot;)] [(200, 2)]</title>
<path fill="none" stroke="black" d="M1503.5,-698.97C1517.63,-688.51 1535.99,-674.9 1551.86,-663.16"/>
</g>
<!-- WITH COLUMNS [&quot;PredictorCategory&quot;] [(300, 3)] -->
<g id="node12" class="node">
<title>WITH COLUMNS [&quot;PredictorCategory&quot;] [(300, 3)]</title>
<polygon fill="none" stroke="black" points="1736.5,-574 1436.5,-574 1436.5,-538 1736.5,-538 1736.5,-574"/>
<text text-anchor="middle" x="1586.5" y="-552.3" font-family="Times,serif" font-size="14.00">WITH COLUMNS [&quot;PredictorCategory&quot;]</text>
</g>
<!-- JOIN INNER
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;left: [col(&quot;ModelID&quot;)];
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;right: [col(&quot;ModelID&quot;)] [(200, 2)]&#45;&#45;WITH COLUMNS [&quot;PredictorCategory&quot;] [(300, 3)] -->
<g id="edge11" class="edge">
<title>JOIN INNER
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;left: [col(&quot;ModelID&quot;)];
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;right: [col(&quot;ModelID&quot;)] [(200, 2)]&#45;&#45;WITH COLUMNS [&quot;PredictorCategory&quot;] [(300, 3)]</title>
<path fill="none" stroke="black" d="M1586.5,-609.8C1586.5,-598.17 1586.5,-584.74 1586.5,-574.33"/>
</g>
<!-- π 1/15 [(400, 3)] -->
<g id="node18" class="node">
<title>π 1/15 [(400, 3)]</title>
<polygon fill="none" stroke="black" points="1911.5,-574 1849.5,-574 1849.5,-538 1911.5,-538 1911.5,-574"/>
<text text-anchor="middle" x="1880.5" y="-552.3" font-family="Times,serif" font-size="14.00">π 1/15</text>
</g>
<!-- JOIN INNER
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;left: [col(&quot;ModelID&quot;)];
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;right: [col(&quot;ModelID&quot;)] [(200, 2)]&#45;&#45;π 1/15 [(400, 3)] -->
<g id="edge17" class="edge">
<title>JOIN INNER
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;left: [col(&quot;ModelID&quot;)];
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;right: [col(&quot;ModelID&quot;)] [(200, 2)]&#45;&#45;π 1/15 [(400, 3)]</title>
<path fill="none" stroke="black" d="M1682.36,-609.9C1740.17,-594.47 1810.04,-575.81 1849.46,-565.29"/>
</g>
<!-- WITH COLUMNS [&quot;BinPropensity&quot;,&quot;BinAdjustedPropensity&quot;] [(300, 4)] -->
<g id="node13" class="node">
<title>WITH COLUMNS [&quot;BinPropensity&quot;,&quot;BinAdjustedPropensity&quot;] [(300, 4)]</title>
<polygon fill="none" stroke="black" points="1812.5,-502 1360.5,-502 1360.5,-466 1812.5,-466 1812.5,-502"/>
<text text-anchor="middle" x="1586.5" y="-480.3" font-family="Times,serif" font-size="14.00">WITH COLUMNS [&quot;BinPropensity&quot;,&quot;BinAdjustedPropensity&quot;]</text>
</g>
<!-- WITH COLUMNS [&quot;PredictorCategory&quot;] [(300, 3)]&#45;&#45;WITH COLUMNS [&quot;BinPropensity&quot;,&quot;BinAdjustedPropensity&quot;] [(300, 4)] -->
<g id="edge12" class="edge">
<title>WITH COLUMNS [&quot;PredictorCategory&quot;] [(300, 3)]&#45;&#45;WITH COLUMNS [&quot;BinPropensity&quot;,&quot;BinAdjustedPropensity&quot;] [(300, 4)]</title>
<path fill="none" stroke="black" d="M1586.5,-537.7C1586.5,-526.85 1586.5,-512.92 1586.5,-502.1"/>
</g>
<!-- WITH COLUMNS [&quot;BinIndex&quot;,&quot;BinType&quot;,&quot;EntryType&quot;,&quot;BinNegatives&quot;,&quot;Type&quot;,&quot;ResponseCount&quot;,&quot;PredictorName&quot;,&quot;BinResponseCount&quot;,&quot;SnapshotTime&quot;,&quot;BinPositives&quot;,&quot;Positives&quot;,&quot;GroupIndex&quot;] [(300, 5)] -->
<g id="node14" class="node">
<title>WITH COLUMNS [&quot;BinIndex&quot;,&quot;BinType&quot;,&quot;EntryType&quot;,&quot;BinNegatives&quot;,&quot;Type&quot;,&quot;ResponseCount&quot;,&quot;PredictorName&quot;,&quot;BinResponseCount&quot;,&quot;SnapshotTime&quot;,&quot;BinPositives&quot;,&quot;Positives&quot;,&quot;GroupIndex&quot;] [(300, 5)]</title>
<polygon fill="none" stroke="black" points="2279.5,-430 893.5,-430 893.5,-394 2279.5,-394 2279.5,-430"/>
<text text-anchor="middle" x="1586.5" y="-408.3" font-family="Times,serif" font-size="14.00">WITH COLUMNS [&quot;BinIndex&quot;,&quot;BinType&quot;,&quot;EntryType&quot;,&quot;BinNegatives&quot;,&quot;Type&quot;,&quot;ResponseCount&quot;,&quot;PredictorName&quot;,&quot;BinResponseCount&quot;,&quot;SnapshotTime&quot;,&quot;BinPositives&quot;,&quot;Positives&quot;,&quot;GroupIndex&quot;]</text>
</g>
<!-- WITH COLUMNS [&quot;BinPropensity&quot;,&quot;BinAdjustedPropensity&quot;] [(300, 4)]&#45;&#45;WITH COLUMNS [&quot;BinIndex&quot;,&quot;BinType&quot;,&quot;EntryType&quot;,&quot;BinNegatives&quot;,&quot;Type&quot;,&quot;ResponseCount&quot;,&quot;PredictorName&quot;,&quot;BinResponseCount&quot;,&quot;SnapshotTime&quot;,&quot;BinPositives&quot;,&quot;Positives&quot;,&quot;GroupIndex&quot;] [(300, 5)] -->
<g id="edge13" class="edge">
<title>WITH COLUMNS [&quot;BinPropensity&quot;,&quot;BinAdjustedPropensity&quot;] [(300, 4)]&#45;&#45;WITH COLUMNS [&quot;BinIndex&quot;,&quot;BinType&quot;,&quot;EntryType&quot;,&quot;BinNegatives&quot;,&quot;Type&quot;,&quot;ResponseCount&quot;,&quot;PredictorName&quot;,&quot;BinResponseCount&quot;,&quot;SnapshotTime&quot;,&quot;BinPositives&quot;,&quot;Positives&quot;,&quot;GroupIndex&quot;] [(300, 5)]</title>
<path fill="none" stroke="black" d="M1586.5,-465.7C1586.5,-454.85 1586.5,-440.92 1586.5,-430.1"/>
</g>
<!-- π 16/36 [(300, 6)] -->
<g id="node15" class="node">
<title>π 16/36 [(300, 6)]</title>
<polygon fill="none" stroke="black" points="1622,-358 1551,-358 1551,-322 1622,-322 1622,-358"/>
<text text-anchor="middle" x="1586.5" y="-336.3" font-family="Times,serif" font-size="14.00">π 16/36</text>
</g>
<!-- WITH COLUMNS [&quot;BinIndex&quot;,&quot;BinType&quot;,&quot;EntryType&quot;,&quot;BinNegatives&quot;,&quot;Type&quot;,&quot;ResponseCount&quot;,&quot;PredictorName&quot;,&quot;BinResponseCount&quot;,&quot;SnapshotTime&quot;,&quot;BinPositives&quot;,&quot;Positives&quot;,&quot;GroupIndex&quot;] [(300, 5)]&#45;&#45;π 16/36 [(300, 6)] -->
<g id="edge14" class="edge">
<title>WITH COLUMNS [&quot;BinIndex&quot;,&quot;BinType&quot;,&quot;EntryType&quot;,&quot;BinNegatives&quot;,&quot;Type&quot;,&quot;ResponseCount&quot;,&quot;PredictorName&quot;,&quot;BinResponseCount&quot;,&quot;SnapshotTime&quot;,&quot;BinPositives&quot;,&quot;Positives&quot;,&quot;GroupIndex&quot;] [(300, 5)]&#45;&#45;π 16/36 [(300, 6)]</title>
<path fill="none" stroke="black" d="M1586.5,-393.7C1586.5,-382.85 1586.5,-368.92 1586.5,-358.1"/>
</g>
<!-- RENAME [(300, 7)] -->
<g id="node16" class="node">
<title>RENAME [(300, 7)]</title>
<polygon fill="none" stroke="black" points="1628.5,-286 1544.5,-286 1544.5,-250 1628.5,-250 1628.5,-286"/>
<text text-anchor="middle" x="1586.5" y="-264.3" font-family="Times,serif" font-size="14.00">RENAME</text>
</g>
<!-- π 16/36 [(300, 6)]&#45;&#45;RENAME [(300, 7)] -->
<g id="edge15" class="edge">
<title>π 16/36 [(300, 6)]&#45;&#45;RENAME [(300, 7)]</title>
<path fill="none" stroke="black" d="M1586.5,-321.7C1586.5,-310.85 1586.5,-296.92 1586.5,-286.1"/>
</g>
<!-- TABLE
π */36;
σ &#45; [(300, 8)] -->
<g id="node17" class="node">
<title>TABLE
π */36;
σ &#45; [(300, 8)]</title>
<polygon fill="none" stroke="black" points="1619,-214 1554,-214 1554,-161 1619,-161 1619,-214"/>
<text text-anchor="middle" x="1586.5" y="-198.8" font-family="Times,serif" font-size="14.00">TABLE</text>
<text text-anchor="middle" x="1586.5" y="-183.8" font-family="Times,serif" font-size="14.00">π */36;</text>
<text text-anchor="middle" x="1586.5" y="-168.8" font-family="Times,serif" font-size="14.00">σ &#45;</text>
</g>
<!-- RENAME [(300, 7)]&#45;&#45;TABLE
π */36;
σ &#45; [(300, 8)] -->
<g id="edge16" class="edge">
<title>RENAME [(300, 7)]&#45;&#45;TABLE
π */36;
σ &#45; [(300, 8)]</title>
<path fill="none" stroke="black" d="M1586.5,-249.97C1586.5,-239.51 1586.5,-225.9 1586.5,-214.16"/>
</g>
<!-- FILTER BY col(&quot;Name&quot;).str.contains(... [(400, 4)] -->
<g id="node19" class="node">
<title>FILTER BY col(&quot;Name&quot;).str.contains(... [(400, 4)]</title>
<polygon fill="none" stroke="black" points="2417.5,-502 2127.5,-502 2127.5,-466 2417.5,-466 2417.5,-502"/>
<text text-anchor="middle" x="2272.5" y="-480.3" font-family="Times,serif" font-size="14.00">FILTER BY col(&quot;Name&quot;).str.contains(...</text>
</g>
<!-- π 1/15 [(400, 3)]&#45;&#45;FILTER BY col(&quot;Name&quot;).str.contains(... [(400, 4)] -->
<g id="edge18" class="edge">
<title>π 1/15 [(400, 3)]&#45;&#45;FILTER BY col(&quot;Name&quot;).str.contains(... [(400, 4)]</title>
<path fill="none" stroke="black" d="M1911.59,-549.45C1968.27,-539.33 2090.53,-517.49 2177,-502.05"/>
</g>
<!-- WITH COLUMNS [&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;] [(400, 5)] -->
<g id="node20" class="node">
<title>WITH COLUMNS [&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;] [(400, 5)]</title>
<polygon fill="none" stroke="black" points="2841.5,-430 2297.5,-430 2297.5,-394 2841.5,-394 2841.5,-430"/>
<text text-anchor="middle" x="2569.5" y="-408.3" font-family="Times,serif" font-size="14.00">WITH COLUMNS [&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;]</text>
</g>
<!-- FILTER BY col(&quot;Name&quot;).str.contains(... [(400, 4)]&#45;&#45;WITH COLUMNS [&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;] [(400, 5)] -->
<g id="edge19" class="edge">
<title>FILTER BY col(&quot;Name&quot;).str.contains(... [(400, 4)]&#45;&#45;WITH COLUMNS [&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;] [(400, 5)]</title>
<path fill="none" stroke="black" d="M2344.77,-465.97C2391.05,-455.06 2450.87,-440.96 2497.16,-430.05"/>
</g>
<!-- FILTER BY col(&quot;Name&quot;).str.contains(... [(400, 6)] -->
<g id="node21" class="node">
<title>FILTER BY col(&quot;Name&quot;).str.contains(... [(400, 6)]</title>
<polygon fill="none" stroke="black" points="2714.5,-358 2424.5,-358 2424.5,-322 2714.5,-322 2714.5,-358"/>
<text text-anchor="middle" x="2569.5" y="-336.3" font-family="Times,serif" font-size="14.00">FILTER BY col(&quot;Name&quot;).str.contains(...</text>
</g>
<!-- WITH COLUMNS [&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;] [(400, 5)]&#45;&#45;FILTER BY col(&quot;Name&quot;).str.contains(... [(400, 6)] -->
<g id="edge20" class="edge">
<title>WITH COLUMNS [&quot;SuccessRate&quot;,&quot;Last_Positives&quot;,&quot;Last_ResponseCount&quot;] [(400, 5)]&#45;&#45;FILTER BY col(&quot;Name&quot;).str.contains(... [(400, 6)]</title>
<path fill="none" stroke="black" d="M2569.5,-393.7C2569.5,-382.85 2569.5,-368.92 2569.5,-358.1"/>
</g>
<!-- WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;] [(400, 7)] -->
<g id="node22" class="node">
<title>WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;] [(400, 7)]</title>
<polygon fill="none" stroke="black" points="3007,-286 2132,-286 2132,-250 3007,-250 3007,-286"/>
<text text-anchor="middle" x="2569.5" y="-264.3" font-family="Times,serif" font-size="14.00">WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;]</text>
</g>
<!-- FILTER BY col(&quot;Name&quot;).str.contains(... [(400, 6)]&#45;&#45;WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;] [(400, 7)] -->
<g id="edge21" class="edge">
<title>FILTER BY col(&quot;Name&quot;).str.contains(... [(400, 6)]&#45;&#45;WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;] [(400, 7)]</title>
<path fill="none" stroke="black" d="M2569.5,-321.7C2569.5,-310.85 2569.5,-296.92 2569.5,-286.1"/>
</g>
<!-- π 12/27 [(400, 8)] -->
<g id="node23" class="node">
<title>π 12/27 [(400, 8)]</title>
<polygon fill="none" stroke="black" points="2605,-205.5 2534,-205.5 2534,-169.5 2605,-169.5 2605,-205.5"/>
<text text-anchor="middle" x="2569.5" y="-183.8" font-family="Times,serif" font-size="14.00">π 12/27</text>
</g>
<!-- WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;] [(400, 7)]&#45;&#45;π 12/27 [(400, 8)] -->
<g id="edge22" class="edge">
<title>WITH COLUMNS [&quot;Group&quot;,&quot;Channel&quot;,&quot;ResponseCount&quot;,&quot;Direction&quot;,&quot;SnapshotTime&quot;,&quot;Configuration&quot;,&quot;Issue&quot;,&quot;Positives&quot;] [(400, 7)]&#45;&#45;π 12/27 [(400, 8)]</title>
<path fill="none" stroke="black" d="M2569.5,-249.97C2569.5,-236.8 2569.5,-218.66 2569.5,-205.5"/>
</g>
<!-- RENAME [(400, 9)] -->
<g id="node24" class="node">
<title>RENAME [(400, 9)]</title>
<polygon fill="none" stroke="black" points="2611.5,-125 2527.5,-125 2527.5,-89 2611.5,-89 2611.5,-125"/>
<text text-anchor="middle" x="2569.5" y="-103.3" font-family="Times,serif" font-size="14.00">RENAME</text>
</g>
<!-- π 12/27 [(400, 8)]&#45;&#45;RENAME [(400, 9)] -->
<g id="edge23" class="edge">
<title>π 12/27 [(400, 8)]&#45;&#45;RENAME [(400, 9)]</title>
<path fill="none" stroke="black" d="M2569.5,-169.47C2569.5,-156.3 2569.5,-138.16 2569.5,-125"/>
</g>
<!-- TABLE
π */27;
σ &#45; [(400, 10)] -->
<g id="node25" class="node">
<title>TABLE
π */27;
σ &#45; [(400, 10)]</title>
<polygon fill="none" stroke="black" points="2602,-53 2537,-53 2537,0 2602,0 2602,-53"/>
<text text-anchor="middle" x="2569.5" y="-37.8" font-family="Times,serif" font-size="14.00">TABLE</text>
<text text-anchor="middle" x="2569.5" y="-22.8" font-family="Times,serif" font-size="14.00">π */27;</text>
<text text-anchor="middle" x="2569.5" y="-7.8" font-family="Times,serif" font-size="14.00">σ &#45;</text>
</g>
<!-- RENAME [(400, 9)]&#45;&#45;TABLE
π */27;
σ &#45; [(400, 10)] -->
<g id="edge24" class="edge">
<title>RENAME [(400, 9)]&#45;&#45;TABLE
π */27;
σ &#45; [(400, 10)]</title>
<path fill="none" stroke="black" d="M2569.5,-88.97C2569.5,-78.51 2569.5,-64.9 2569.5,-53.16"/>
</g>
</g>
</svg></div>
</div>
<p>While a beautiful graph, it is quite a lot to digest. The left side of the chart should look very familiar, as should the right side. The ‘middle’ part is new: this is the execution part for the predictor data. Here we only parse <code class="docutils literal notranslate"><span class="pre">Performance</span></code> to be a float, parse the timezones, and add [“BinPropensity”,”BinAdjustedPropensity”]. For both the model data and the predictor data we take the last snapshot only when combining them, which you can see right before the topmost inner join.</p>
<p>Again, a sharp eye will notice quite some inefficiencies here. The newest issue is that we’re now importing <code class="docutils literal notranslate"><span class="pre">modelData</span></code> twice, once to filter out model IDs not being in the filter criteria, and another time to join with the table. But remember, we’re not in the optimized graph:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm</span><span class="o">.</span><span class="n">combinedData</span><span class="o">.</span><span class="n">show_graph</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">InvalidOperationError</span>                     Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[9], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">dm</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">combinedData</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">show_graph</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/polars/lazyframe/frame.py:1035</span>, in <span class="ansi-cyan-fg">LazyFrame.show_graph</span><span class="ansi-blue-fg">(self, optimized, show, output_path, raw_output, figsize, type_coercion, predicate_pushdown, projection_pushdown, simplify_expression, slice_pushdown, comm_subplan_elim, comm_subexpr_elim, streaming)</span>
<span class="ansi-green-intense-fg ansi-bold">    975</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    976</span> <span style="color: rgb(175,0,0)">Show a plot of the query plan.</span>
<span class="ansi-green-intense-fg ansi-bold">    977</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">   1021</span> <span style="color: rgb(175,0,0)">... ).show_graph()  # doctest: +SKIP</span>
<span class="ansi-green-intense-fg ansi-bold">   1022</span> <span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   1023</span> _ldf <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_ldf<span style="color: rgb(98,98,98)">.</span>optimization_toggle(
<span class="ansi-green-intense-fg ansi-bold">   1024</span>     type_coercion,
<span class="ansi-green-intense-fg ansi-bold">   1025</span>     predicate_pushdown,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">   1032</span>     _eager<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">False</span>,
<span class="ansi-green-intense-fg ansi-bold">   1033</span> )
<span class="ansi-green-fg">-&gt; 1035</span> dot <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_ldf</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">to_dot</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">optimized</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1037</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> raw_output:
<span class="ansi-green-intense-fg ansi-bold">   1038</span>     <span style="color: rgb(95,135,135)"># we do not show a graph, nor save a graph to disk</span>
<span class="ansi-green-intense-fg ansi-bold">   1039</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> dot

<span class="ansi-red-fg">InvalidOperationError</span>: could not determine supertype of: [datetime[ns], dyn int]


This error occurred with the following context stack:
        [1] &#39;filter&#39; failed
        [2] &#39;join left&#39; input failed to resolve

</pre></div></div>
</div>
<p>Pretty neat. Not only do we not import modelData twice, we cache it at a certain point in the execution graph so we can <em>use</em> it twice. And we get all of this for free with Polars’ optimization engine! Also remember, at this point, we’ve not even read in any data yet! We can even do profiling on this execution graph, but that’s a challenge to figure out on your own :). We can easily show the gains in time using this method using our new <code class="docutils literal notranslate"><span class="pre">save_data</span></code> method though: this will save our data to
disk in an efficient format, and gives us a fast way to benchmark.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">files_without_subset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CDHSample</span><span class="p">(</span>
    <span class="n">import_strategy</span><span class="o">=</span><span class="s2">&quot;lazy&quot;</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span><span class="o">.</span><span class="n">save_data</span><span class="p">()</span>
<span class="n">files_with_subset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CDHSample</span><span class="p">(</span>
    <span class="n">import_strategy</span><span class="o">=</span><span class="s2">&quot;lazy&quot;</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;Visa&quot;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">save_data</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> ADMDatamart(model_filename=files_without_subset[0], predictor_filename=files_without_subset[1], import_strategy=&#39;lazy&#39;).combinedData.collect()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">InvalidOperationError</span>                     Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[11], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">get_ipython</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">run_line_magic</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">timeit</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">ADMDatamart(model_filename=files_without_subset[0], predictor_filename=files_without_subset[1], import_strategy=</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">lazy</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">).combinedData.collect()</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/IPython/core/interactiveshell.py:2480</span>, in <span class="ansi-cyan-fg">InteractiveShell.run_line_magic</span><span class="ansi-blue-fg">(self, magic_name, line, _stack_depth)</span>
<span class="ansi-green-intense-fg ansi-bold">   2478</span>     kwargs[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">local_ns</span><span style="color: rgb(175,0,0)">&#39;</span>] <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>get_local_scope(stack_depth)
<span class="ansi-green-intense-fg ansi-bold">   2479</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>builtin_trap:
<span class="ansi-green-fg">-&gt; 2480</span>     result <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">fn</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2482</span> <span style="color: rgb(95,135,135)"># The code below prevents the output from being displayed</span>
<span class="ansi-green-intense-fg ansi-bold">   2483</span> <span style="color: rgb(95,135,135)"># when using magics with decorator @output_can_be_silenced</span>
<span class="ansi-green-intense-fg ansi-bold">   2484</span> <span style="color: rgb(95,135,135)"># when the last Python token in the expression is a &#39;;&#39;.</span>
<span class="ansi-green-intense-fg ansi-bold">   2485</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">getattr</span>(fn, magic<span style="color: rgb(98,98,98)">.</span>MAGIC_OUTPUT_CAN_BE_SILENCED, <span class="ansi-bold" style="color: rgb(0,135,0)">False</span>):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/IPython/core/magics/execution.py:1185</span>, in <span class="ansi-cyan-fg">ExecutionMagics.timeit</span><span class="ansi-blue-fg">(self, line, cell, local_ns)</span>
<span class="ansi-green-intense-fg ansi-bold">   1183</span> <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> index <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">range</span>(<span style="color: rgb(98,98,98)">0</span>, <span style="color: rgb(98,98,98)">10</span>):
<span class="ansi-green-intense-fg ansi-bold">   1184</span>     number <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(98,98,98)">10</span> <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span> index
<span class="ansi-green-fg">-&gt; 1185</span>     time_number <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">timer</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">timeit</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">number</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1186</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> time_number <span style="color: rgb(98,98,98)">&gt;</span><span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(98,98,98)">0.2</span>:
<span class="ansi-green-intense-fg ansi-bold">   1187</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">break</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/IPython/core/magics/execution.py:173</span>, in <span class="ansi-cyan-fg">Timer.timeit</span><span class="ansi-blue-fg">(self, number)</span>
<span class="ansi-green-intense-fg ansi-bold">    171</span> gc<span style="color: rgb(98,98,98)">.</span>disable()
<span class="ansi-green-intense-fg ansi-bold">    172</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; 173</span>     timing <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">inner</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">it</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">timer</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    174</span> <span class="ansi-bold" style="color: rgb(0,135,0)">finally</span>:
<span class="ansi-green-intense-fg ansi-bold">    175</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> gcold:

File <span class="ansi-green-fg">&lt;magic-timeit&gt;:1</span>, in <span class="ansi-cyan-fg">inner</span><span class="ansi-blue-fg">(_it, _timer)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/polars/lazyframe/frame.py:1816</span>, in <span class="ansi-cyan-fg">LazyFrame.collect</span><span class="ansi-blue-fg">(self, type_coercion, predicate_pushdown, projection_pushdown, simplify_expression, slice_pushdown, comm_subplan_elim, comm_subexpr_elim, no_optimization, streaming, background, _eager, **_kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1813</span> <span style="color: rgb(95,135,135)"># Only for testing purposes atm.</span>
<span class="ansi-green-intense-fg ansi-bold">   1814</span> callback <span style="color: rgb(98,98,98)">=</span> _kwargs<span style="color: rgb(98,98,98)">.</span>get(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">post_opt_callback</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-fg">-&gt; 1816</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> wrap_df(<span class="ansi-yellow-bg">ldf</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">collect</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">callback</span><span class="ansi-yellow-bg">)</span>)

<span class="ansi-red-fg">InvalidOperationError</span>: could not determine supertype of: [datetime[ns], dyn int]


This error occurred with the following context stack:
        [1] &#39;filter&#39; failed
        [2] &#39;join left&#39; input failed to resolve

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> ADMDatamart(model_filename=files_with_subset[0], predictor_filename=files_with_subset[1], import_strategy=&#39;lazy&#39;).combinedData.collect()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">InvalidOperationError</span>                     Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[12], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">get_ipython</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">run_line_magic</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">timeit</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">ADMDatamart(model_filename=files_with_subset[0], predictor_filename=files_with_subset[1], import_strategy=</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">lazy</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">).combinedData.collect()</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/IPython/core/interactiveshell.py:2480</span>, in <span class="ansi-cyan-fg">InteractiveShell.run_line_magic</span><span class="ansi-blue-fg">(self, magic_name, line, _stack_depth)</span>
<span class="ansi-green-intense-fg ansi-bold">   2478</span>     kwargs[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">local_ns</span><span style="color: rgb(175,0,0)">&#39;</span>] <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>get_local_scope(stack_depth)
<span class="ansi-green-intense-fg ansi-bold">   2479</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>builtin_trap:
<span class="ansi-green-fg">-&gt; 2480</span>     result <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">fn</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2482</span> <span style="color: rgb(95,135,135)"># The code below prevents the output from being displayed</span>
<span class="ansi-green-intense-fg ansi-bold">   2483</span> <span style="color: rgb(95,135,135)"># when using magics with decorator @output_can_be_silenced</span>
<span class="ansi-green-intense-fg ansi-bold">   2484</span> <span style="color: rgb(95,135,135)"># when the last Python token in the expression is a &#39;;&#39;.</span>
<span class="ansi-green-intense-fg ansi-bold">   2485</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">getattr</span>(fn, magic<span style="color: rgb(98,98,98)">.</span>MAGIC_OUTPUT_CAN_BE_SILENCED, <span class="ansi-bold" style="color: rgb(0,135,0)">False</span>):

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/IPython/core/magics/execution.py:1185</span>, in <span class="ansi-cyan-fg">ExecutionMagics.timeit</span><span class="ansi-blue-fg">(self, line, cell, local_ns)</span>
<span class="ansi-green-intense-fg ansi-bold">   1183</span> <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> index <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">range</span>(<span style="color: rgb(98,98,98)">0</span>, <span style="color: rgb(98,98,98)">10</span>):
<span class="ansi-green-intense-fg ansi-bold">   1184</span>     number <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(98,98,98)">10</span> <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span> index
<span class="ansi-green-fg">-&gt; 1185</span>     time_number <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">timer</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">timeit</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">number</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1186</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> time_number <span style="color: rgb(98,98,98)">&gt;</span><span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(98,98,98)">0.2</span>:
<span class="ansi-green-intense-fg ansi-bold">   1187</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">break</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/IPython/core/magics/execution.py:173</span>, in <span class="ansi-cyan-fg">Timer.timeit</span><span class="ansi-blue-fg">(self, number)</span>
<span class="ansi-green-intense-fg ansi-bold">    171</span> gc<span style="color: rgb(98,98,98)">.</span>disable()
<span class="ansi-green-intense-fg ansi-bold">    172</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; 173</span>     timing <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">inner</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">it</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">timer</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    174</span> <span class="ansi-bold" style="color: rgb(0,135,0)">finally</span>:
<span class="ansi-green-intense-fg ansi-bold">    175</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> gcold:

File <span class="ansi-green-fg">&lt;magic-timeit&gt;:1</span>, in <span class="ansi-cyan-fg">inner</span><span class="ansi-blue-fg">(_it, _timer)</span>

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/polars/lazyframe/frame.py:1816</span>, in <span class="ansi-cyan-fg">LazyFrame.collect</span><span class="ansi-blue-fg">(self, type_coercion, predicate_pushdown, projection_pushdown, simplify_expression, slice_pushdown, comm_subplan_elim, comm_subexpr_elim, no_optimization, streaming, background, _eager, **_kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1813</span> <span style="color: rgb(95,135,135)"># Only for testing purposes atm.</span>
<span class="ansi-green-intense-fg ansi-bold">   1814</span> callback <span style="color: rgb(98,98,98)">=</span> _kwargs<span style="color: rgb(98,98,98)">.</span>get(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">post_opt_callback</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-fg">-&gt; 1816</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> wrap_df(<span class="ansi-yellow-bg">ldf</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">collect</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">callback</span><span class="ansi-yellow-bg">)</span>)

<span class="ansi-red-fg">InvalidOperationError</span>: could not determine supertype of: [datetime[ns], dyn int]


This error occurred with the following context stack:
        [1] &#39;filter&#39; failed
        [2] &#39;join left&#39; input failed to resolve

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">remove</span>
<span class="p">[</span><span class="n">remove</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="p">[</span><span class="o">*</span><span class="n">files_with_subset</span><span class="p">,</span> <span class="o">*</span><span class="n">files_without_subset</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[None, None, None, None]
</pre></div></div>
</div>
<p>This +- 2x increase in speed will be even more significant as we increase the size of the data.</p>
</section>
<section id="Lazy-vs-Eager">
<h2>Lazy vs Eager<a class="headerlink" href="#Lazy-vs-Eager" title="Link to this heading">¶</a></h2>
<p>As mentioned before, however, the default mode of reading is <code class="docutils literal notranslate"><span class="pre">&quot;eager&quot;</span></code>. This still allows us to use the previously mentioned execution graph, but the difference is in what we do after we do all of this preprocessing, right before returning the ADMDatamart class: <code class="docutils literal notranslate"><span class="pre">.collect().lazy()</span></code>. Opening up <code class="docutils literal notranslate"><span class="pre">modelData</span></code> in <code class="docutils literal notranslate"><span class="pre">eager</span></code> mode shows that we don’t have a graph anymore:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modd</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CDHSample</span><span class="p">()</span><span class="o">.</span><span class="n">modelData</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">modd</span><span class="p">))</span>
<span class="n">modd</span><span class="o">.</span><span class="n">show_graph</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">InvalidOperationError</span>                     Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[14], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> modd <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">datasets</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">CDHSample</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span><span style="color: rgb(98,98,98)">.</span>modelData
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(0,135,0)">print</span>(<span style="color: rgb(0,135,0)">type</span>(modd))
<span class="ansi-green-intense-fg ansi-bold">      3</span> modd<span style="color: rgb(98,98,98)">.</span>show_graph()

File <span class="ansi-green-fg">~/work/pega-datascientist-tools/pega-datascientist-tools/python/docs/source/articles/../../../pdstools/utils/datasets.py:10</span>, in <span class="ansi-cyan-fg">CDHSample</span><span class="ansi-blue-fg">(plotting_engine, query, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">      8</span> models <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Data-Decision-ADM-ModelSnapshot_pyModelSnapshots_20210526T131808_GMT.zip</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">      9</span> predictors <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Data-Decision-ADM-PredictorBinningSnapshot_pyADMPredictorSnapshots_20210526T133622_GMT.zip</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-fg">---&gt; 10</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">ADMDatamart</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">     11</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">path</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">path</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     12</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">model_filename</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">models</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     13</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">predictor_filename</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">predictors</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     14</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">plotting_engine</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">plotting_engine</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     15</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">query</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">query</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     16</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     17</span> <span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/work/pega-datascientist-tools/pega-datascientist-tools/python/docs/source/articles/../../../pdstools/adm/ADMDatamart.py:179</span>, in <span class="ansi-cyan-fg">ADMDatamart.__init__</span><span class="ansi-blue-fg">(self, path, import_strategy, model_filename, predictor_filename, model_df, predictor_df, query, subset, drop_cols, include_cols, context_keys, extract_keys, predictorCategorization, plotting_engine, verbose, **reading_opts)</span>
<span class="ansi-green-intense-fg ansi-bold">    176</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>plotting_engine <span style="color: rgb(98,98,98)">=</span> plotting_engine
<span class="ansi-green-intense-fg ansi-bold">    177</span> <span style="color: rgb(0,135,0)">super</span>()<span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,255)">__init__</span>()
<span class="ansi-green-fg">--&gt; 179</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">processTables</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">query</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/work/pega-datascientist-tools/pega-datascientist-tools/python/docs/source/articles/../../../pdstools/adm/ADMDatamart.py:670</span>, in <span class="ansi-cyan-fg">ADMDatamart.processTables</span><span class="ansi-blue-fg">(self, query)</span>
<span class="ansi-green-intense-fg ansi-bold">    667</span>         <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>predictorData <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>predictorData<span style="color: rgb(98,98,98)">.</span>collect()<span style="color: rgb(98,98,98)">.</span>lazy()
<span class="ansi-green-intense-fg ansi-bold">    669</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>predictorData <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>modelData <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-fg">--&gt; 670</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>combinedData <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_get_combined_data</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">strategy</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">import_strategy</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    671</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>verbose:
<span class="ansi-green-intense-fg ansi-bold">    672</span>     <span style="color: rgb(0,135,0)">print</span>(
<span class="ansi-green-intense-fg ansi-bold">    673</span>         <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Could not be combined. Do you have both model data and predictor data?</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    674</span>     )

File <span class="ansi-green-fg">~/work/pega-datascientist-tools/pega-datascientist-tools/python/docs/source/articles/../../../pdstools/adm/ADMDatamart.py:630</span>, in <span class="ansi-cyan-fg">ADMDatamart._get_combined_data</span><span class="ansi-blue-fg">(self, last, strategy)</span>
<span class="ansi-green-intense-fg ansi-bold">    628</span> combined <span style="color: rgb(98,98,98)">=</span> models<span style="color: rgb(98,98,98)">.</span>join(preds, on<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">ModelID</span><span style="color: rgb(175,0,0)">&#34;</span>, how<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">inner</span><span style="color: rgb(175,0,0)">&#34;</span>, suffix<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Bin</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-intense-fg ansi-bold">    629</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> strategy <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">eager</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-fg">--&gt; 630</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">combined</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">collect</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span><span style="color: rgb(98,98,98)">.</span>lazy()
<span class="ansi-green-intense-fg ansi-bold">    631</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">    632</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> combined

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/polars/lazyframe/frame.py:1816</span>, in <span class="ansi-cyan-fg">LazyFrame.collect</span><span class="ansi-blue-fg">(self, type_coercion, predicate_pushdown, projection_pushdown, simplify_expression, slice_pushdown, comm_subplan_elim, comm_subexpr_elim, no_optimization, streaming, background, _eager, **_kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1813</span> <span style="color: rgb(95,135,135)"># Only for testing purposes atm.</span>
<span class="ansi-green-intense-fg ansi-bold">   1814</span> callback <span style="color: rgb(98,98,98)">=</span> _kwargs<span style="color: rgb(98,98,98)">.</span>get(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">post_opt_callback</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-fg">-&gt; 1816</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> wrap_df(<span class="ansi-yellow-bg">ldf</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">collect</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">callback</span><span class="ansi-yellow-bg">)</span>)

<span class="ansi-red-fg">InvalidOperationError</span>: could not determine supertype of: [datetime[ns], dyn int]


This error occurred with the following context stack:
        [1] &#39;filter&#39; failed
        [2] &#39;join left&#39; input failed to resolve

</pre></div></div>
</div>
<p>The type of <code class="docutils literal notranslate"><span class="pre">modelData</span></code> is a <code class="docutils literal notranslate"><span class="pre">LazyFrame</span></code> (the representation of this being a query plan). <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> and <code class="docutils literal notranslate"><span class="pre">LazyFrame</span></code>s are not so different - <code class="docutils literal notranslate"><span class="pre">LazyFrame</span></code>s build up a query and want you to execute once it’s done, <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s execute each command as you’re calling it. However, in <code class="docutils literal notranslate"><span class="pre">eager</span></code> mode, that execution graph is empty.</p>
<p>That leads to the fundamental difference between the <code class="docutils literal notranslate"><span class="pre">import_strategy</span></code> keyword argument: - In <code class="docutils literal notranslate"><span class="pre">lazy</span></code> mode - we only build the execution graph, but we rather than <em>reading</em> the data, we only <em>scan</em> it - In <code class="docutils literal notranslate"><span class="pre">eager</span></code> mode - we build the execution graph and execute it, <em>reading</em> all data into memory. This means we don’t have to execute that graph everytime we call it.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">eager</span></code> mode stil maintains <code class="docutils literal notranslate"><span class="pre">LazyFrame</span></code>s for both <code class="docutils literal notranslate"><span class="pre">modelData</span></code> and <code class="docutils literal notranslate"><span class="pre">predictorData</span></code>, but those tables are now not stored on disk anymore, but kept in memory. Any subsequent operations will build up a new execution graph, only executed when calling <code class="docutils literal notranslate"><span class="pre">.collect()</span></code>.</p>
<section id="When-to-use-which?">
<h3>When to use which?<a class="headerlink" href="#When-to-use-which?" title="Link to this heading">¶</a></h3>
<p>By default, we use <code class="docutils literal notranslate"><span class="pre">eager</span></code> mode. We recommend using that, unless:</p>
<ul class="simple">
<li><p>Your data is too big to fit into memory</p></li>
<li><p>You’re using just one plot</p></li>
</ul>
<p>In all other cases, it’s probably fine to just use eager mode, <em>unless</em>.</p>
</section>
</section>
<section id="File-Types">
<h2>File Types<a class="headerlink" href="#File-Types" title="Link to this heading">¶</a></h2>
<p>Pega’s default export format is to return a zip file, in which is a <code class="docutils literal notranslate"><span class="pre">data.json</span></code> file, which is in newline-delimited json format. While this is a decent storage format, it doesn’t allow for any scanning operations because we need to open the entire zip into memory before being able to read anything. Therefore, if you’re using the default export format, we set the import strategy to eager. If you’re working with very large files and you need faster processing, it may be worth it to unzip the
files, or even transform them to Arrow/IPC (fastest) or Parquet (most efficient). Then, you can use lazy mode, and can process files larger than memory as an added benefit.</p>
</section>
<section id="Further-Polars-examples">
<h2>Further Polars examples<a class="headerlink" href="#Further-Polars-examples" title="Link to this heading">¶</a></h2>
<p>To help you get adjusted to this new syntax, let’s go over a few more examples.</p>
<p>The regular facets syntax still works, and can be combined with the new querying syntax.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CDHSample</span><span class="p">()</span>

<span class="n">dm</span><span class="o">.</span><span class="n">plotPerformanceSuccessRateBubbleChart</span><span class="p">(</span>
    <span class="n">query</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Issue&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Sales&quot;</span><span class="p">,</span> <span class="n">facets</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Channel&quot;</span><span class="p">]</span>
<span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">InvalidOperationError</span>                     Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[15], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> dm <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">datasets</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">CDHSample</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> dm<span style="color: rgb(98,98,98)">.</span>plotPerformanceSuccessRateBubbleChart(
<span class="ansi-green-intense-fg ansi-bold">      4</span>     query<span style="color: rgb(98,98,98)">=</span>pl<span style="color: rgb(98,98,98)">.</span>col(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Issue</span><span style="color: rgb(175,0,0)">&#34;</span>) <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Sales</span><span style="color: rgb(175,0,0)">&#34;</span>, facets<span style="color: rgb(98,98,98)">=</span>[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Channel</span><span style="color: rgb(175,0,0)">&#34;</span>]
<span class="ansi-green-intense-fg ansi-bold">      5</span> )

File <span class="ansi-green-fg">~/work/pega-datascientist-tools/pega-datascientist-tools/python/docs/source/articles/../../../pdstools/utils/datasets.py:10</span>, in <span class="ansi-cyan-fg">CDHSample</span><span class="ansi-blue-fg">(plotting_engine, query, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">      8</span> models <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Data-Decision-ADM-ModelSnapshot_pyModelSnapshots_20210526T131808_GMT.zip</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">      9</span> predictors <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Data-Decision-ADM-PredictorBinningSnapshot_pyADMPredictorSnapshots_20210526T133622_GMT.zip</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-fg">---&gt; 10</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">ADMDatamart</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">     11</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">path</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">path</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     12</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">model_filename</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">models</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     13</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">predictor_filename</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">predictors</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     14</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">plotting_engine</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">plotting_engine</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     15</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">query</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">query</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     16</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     17</span> <span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/work/pega-datascientist-tools/pega-datascientist-tools/python/docs/source/articles/../../../pdstools/adm/ADMDatamart.py:179</span>, in <span class="ansi-cyan-fg">ADMDatamart.__init__</span><span class="ansi-blue-fg">(self, path, import_strategy, model_filename, predictor_filename, model_df, predictor_df, query, subset, drop_cols, include_cols, context_keys, extract_keys, predictorCategorization, plotting_engine, verbose, **reading_opts)</span>
<span class="ansi-green-intense-fg ansi-bold">    176</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>plotting_engine <span style="color: rgb(98,98,98)">=</span> plotting_engine
<span class="ansi-green-intense-fg ansi-bold">    177</span> <span style="color: rgb(0,135,0)">super</span>()<span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,255)">__init__</span>()
<span class="ansi-green-fg">--&gt; 179</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">processTables</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">query</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/work/pega-datascientist-tools/pega-datascientist-tools/python/docs/source/articles/../../../pdstools/adm/ADMDatamart.py:670</span>, in <span class="ansi-cyan-fg">ADMDatamart.processTables</span><span class="ansi-blue-fg">(self, query)</span>
<span class="ansi-green-intense-fg ansi-bold">    667</span>         <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>predictorData <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>predictorData<span style="color: rgb(98,98,98)">.</span>collect()<span style="color: rgb(98,98,98)">.</span>lazy()
<span class="ansi-green-intense-fg ansi-bold">    669</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>predictorData <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>modelData <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-fg">--&gt; 670</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>combinedData <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_get_combined_data</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">strategy</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">import_strategy</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    671</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>verbose:
<span class="ansi-green-intense-fg ansi-bold">    672</span>     <span style="color: rgb(0,135,0)">print</span>(
<span class="ansi-green-intense-fg ansi-bold">    673</span>         <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Could not be combined. Do you have both model data and predictor data?</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    674</span>     )

File <span class="ansi-green-fg">~/work/pega-datascientist-tools/pega-datascientist-tools/python/docs/source/articles/../../../pdstools/adm/ADMDatamart.py:630</span>, in <span class="ansi-cyan-fg">ADMDatamart._get_combined_data</span><span class="ansi-blue-fg">(self, last, strategy)</span>
<span class="ansi-green-intense-fg ansi-bold">    628</span> combined <span style="color: rgb(98,98,98)">=</span> models<span style="color: rgb(98,98,98)">.</span>join(preds, on<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">ModelID</span><span style="color: rgb(175,0,0)">&#34;</span>, how<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">inner</span><span style="color: rgb(175,0,0)">&#34;</span>, suffix<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Bin</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-intense-fg ansi-bold">    629</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> strategy <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">eager</span><span style="color: rgb(175,0,0)">&#34;</span>:
<span class="ansi-green-fg">--&gt; 630</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">combined</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">collect</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span><span style="color: rgb(98,98,98)">.</span>lazy()
<span class="ansi-green-intense-fg ansi-bold">    631</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">    632</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> combined

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/polars/lazyframe/frame.py:1816</span>, in <span class="ansi-cyan-fg">LazyFrame.collect</span><span class="ansi-blue-fg">(self, type_coercion, predicate_pushdown, projection_pushdown, simplify_expression, slice_pushdown, comm_subplan_elim, comm_subexpr_elim, no_optimization, streaming, background, _eager, **_kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1813</span> <span style="color: rgb(95,135,135)"># Only for testing purposes atm.</span>
<span class="ansi-green-intense-fg ansi-bold">   1814</span> callback <span style="color: rgb(98,98,98)">=</span> _kwargs<span style="color: rgb(98,98,98)">.</span>get(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">post_opt_callback</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-fg">-&gt; 1816</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> wrap_df(<span class="ansi-yellow-bg">ldf</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">collect</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">callback</span><span class="ansi-yellow-bg">)</span>)

<span class="ansi-red-fg">InvalidOperationError</span>: could not determine supertype of: [datetime[ns], dyn int]


This error occurred with the following context stack:
        [1] &#39;filter&#39; failed
        [2] &#39;join left&#39; input failed to resolve

</pre></div></div>
</div>
<p>However, if you want to <em>combine</em> queries, let’s say just looking at Sales/Web, the best way to do that is like this (also note the extra brackets between expressions):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm</span><span class="o">.</span><span class="n">plotPerformanceSuccessRateBubbleChart</span><span class="p">(</span>
    <span class="n">query</span><span class="o">=</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Issue&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Sales&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Channel&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Web&quot;</span><span class="p">)</span>
<span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">InvalidOperationError</span>                     Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[16], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">dm</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">plotPerformanceSuccessRateBubbleChart</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">query</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">pl</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">col</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">Issue</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">==</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">Sales</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">&amp;</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">pl</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">col</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">Channel</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">==</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">Web</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/work/pega-datascientist-tools/pega-datascientist-tools/python/docs/source/articles/../../../pdstools/plots/plot_base.py:400</span>, in <span class="ansi-cyan-fg">Plots.plotPerformanceSuccessRateBubbleChart</span><span class="ansi-blue-fg">(self, last, add_bottom_left_text, query, facets, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    390</span> df, facets <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_subset_data(
<span class="ansi-green-intense-fg ansi-bold">    391</span>     table<span style="color: rgb(98,98,98)">=</span>table,
<span class="ansi-green-intense-fg ansi-bold">    392</span>     required_columns<span style="color: rgb(98,98,98)">=</span>required_columns,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    395</span>     last<span style="color: rgb(98,98,98)">=</span>last,
<span class="ansi-green-intense-fg ansi-bold">    396</span> )
<span class="ansi-green-intense-fg ansi-bold">    397</span> df <span style="color: rgb(98,98,98)">=</span> df<span style="color: rgb(98,98,98)">.</span>with_columns(
<span class="ansi-green-intense-fg ansi-bold">    398</span>     (pl<span style="color: rgb(98,98,98)">.</span>col([<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Performance</span><span style="color: rgb(175,0,0)">&#34;</span>]) <span style="color: rgb(98,98,98)">*</span> pl<span style="color: rgb(98,98,98)">.</span>lit(<span style="color: rgb(98,98,98)">100</span>))<span style="color: rgb(98,98,98)">.</span>round(kwargs<span style="color: rgb(98,98,98)">.</span>pop(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">round</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(98,98,98)">5</span>))
<span class="ansi-green-intense-fg ansi-bold">    399</span> )
<span class="ansi-green-fg">--&gt; 400</span> df <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">df</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">collect</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    401</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> kwargs<span style="color: rgb(98,98,98)">.</span>pop(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">return_df</span><span style="color: rgb(175,0,0)">&#34;</span>, <span class="ansi-bold" style="color: rgb(0,135,0)">False</span>):
<span class="ansi-green-intense-fg ansi-bold">    402</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> df

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/polars/lazyframe/frame.py:1816</span>, in <span class="ansi-cyan-fg">LazyFrame.collect</span><span class="ansi-blue-fg">(self, type_coercion, predicate_pushdown, projection_pushdown, simplify_expression, slice_pushdown, comm_subplan_elim, comm_subexpr_elim, no_optimization, streaming, background, _eager, **_kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1813</span> <span style="color: rgb(95,135,135)"># Only for testing purposes atm.</span>
<span class="ansi-green-intense-fg ansi-bold">   1814</span> callback <span style="color: rgb(98,98,98)">=</span> _kwargs<span style="color: rgb(98,98,98)">.</span>get(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">post_opt_callback</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-fg">-&gt; 1816</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> wrap_df(<span class="ansi-yellow-bg">ldf</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">collect</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">callback</span><span class="ansi-yellow-bg">)</span>)

<span class="ansi-red-fg">InvalidOperationError</span>: could not determine supertype of: [datetime[ns], dyn int]


This error occurred with the following context stack:
        [1] &#39;filter&#39; failed
        [2] &#39;select&#39; input failed to resolve
        [3] &#39;with_columns&#39; input failed to resolve
        [4] &#39;with_columns&#39; input failed to resolve

</pre></div></div>
</div>
<p>We can make use of string operations (hover to verify for yourself!):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm</span><span class="o">.</span><span class="n">plotPerformanceSuccessRateBubbleChart</span><span class="p">(</span>
    <span class="n">query</span><span class="o">=</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">starts_with</span><span class="p">(</span><span class="s2">&quot;Premier&quot;</span><span class="p">))</span>
    <span class="o">|</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">ends_with</span><span class="p">(</span><span class="s2">&quot;Gold&quot;</span><span class="p">))</span>
<span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">InvalidOperationError</span>                     Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[17], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">dm</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">plotPerformanceSuccessRateBubbleChart</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">query</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">pl</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">col</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">Name</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">str</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">starts_with</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">Premier</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">|</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">pl</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">col</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">Name</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">str</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">ends_with</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">Gold</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/work/pega-datascientist-tools/pega-datascientist-tools/python/docs/source/articles/../../../pdstools/plots/plot_base.py:400</span>, in <span class="ansi-cyan-fg">Plots.plotPerformanceSuccessRateBubbleChart</span><span class="ansi-blue-fg">(self, last, add_bottom_left_text, query, facets, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    390</span> df, facets <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_subset_data(
<span class="ansi-green-intense-fg ansi-bold">    391</span>     table<span style="color: rgb(98,98,98)">=</span>table,
<span class="ansi-green-intense-fg ansi-bold">    392</span>     required_columns<span style="color: rgb(98,98,98)">=</span>required_columns,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    395</span>     last<span style="color: rgb(98,98,98)">=</span>last,
<span class="ansi-green-intense-fg ansi-bold">    396</span> )
<span class="ansi-green-intense-fg ansi-bold">    397</span> df <span style="color: rgb(98,98,98)">=</span> df<span style="color: rgb(98,98,98)">.</span>with_columns(
<span class="ansi-green-intense-fg ansi-bold">    398</span>     (pl<span style="color: rgb(98,98,98)">.</span>col([<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Performance</span><span style="color: rgb(175,0,0)">&#34;</span>]) <span style="color: rgb(98,98,98)">*</span> pl<span style="color: rgb(98,98,98)">.</span>lit(<span style="color: rgb(98,98,98)">100</span>))<span style="color: rgb(98,98,98)">.</span>round(kwargs<span style="color: rgb(98,98,98)">.</span>pop(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">round</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(98,98,98)">5</span>))
<span class="ansi-green-intense-fg ansi-bold">    399</span> )
<span class="ansi-green-fg">--&gt; 400</span> df <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">df</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">collect</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    401</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> kwargs<span style="color: rgb(98,98,98)">.</span>pop(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">return_df</span><span style="color: rgb(175,0,0)">&#34;</span>, <span class="ansi-bold" style="color: rgb(0,135,0)">False</span>):
<span class="ansi-green-intense-fg ansi-bold">    402</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> df

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/polars/lazyframe/frame.py:1816</span>, in <span class="ansi-cyan-fg">LazyFrame.collect</span><span class="ansi-blue-fg">(self, type_coercion, predicate_pushdown, projection_pushdown, simplify_expression, slice_pushdown, comm_subplan_elim, comm_subexpr_elim, no_optimization, streaming, background, _eager, **_kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1813</span> <span style="color: rgb(95,135,135)"># Only for testing purposes atm.</span>
<span class="ansi-green-intense-fg ansi-bold">   1814</span> callback <span style="color: rgb(98,98,98)">=</span> _kwargs<span style="color: rgb(98,98,98)">.</span>get(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">post_opt_callback</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-fg">-&gt; 1816</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> wrap_df(<span class="ansi-yellow-bg">ldf</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">collect</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">callback</span><span class="ansi-yellow-bg">)</span>)

<span class="ansi-red-fg">InvalidOperationError</span>: could not determine supertype of: [datetime[ns], dyn int]


This error occurred with the following context stack:
        [1] &#39;filter&#39; failed
        [2] &#39;select&#39; input failed to resolve
        [3] &#39;with_columns&#39; input failed to resolve
        [4] &#39;with_columns&#39; input failed to resolve

</pre></div></div>
</div>
<p>Since we have full access to Polar’s expressions, we can use a <a class="reference external" href="https://pola-rs.github.io/polars/py-polars/html/reference/expressions/index.html">very wide range of functions</a>, including windowing, folds, and slices.</p>
<p>For something more advanced: let’s look at the highest performance model per group.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm</span><span class="o">.</span><span class="n">plotPerformanceSuccessRateBubbleChart</span><span class="p">(</span>
    <span class="n">query</span><span class="o">=</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;Performance&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">pl</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s2">&quot;Performance&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="s2">&quot;Group&quot;</span><span class="p">)</span>
<span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">InvalidOperationError</span>                     Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[18], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">dm</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">plotPerformanceSuccessRateBubbleChart</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">query</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">pl</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">col</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">Performance</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">==</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">pl</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">max</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">Performance</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">over</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">Group</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/work/pega-datascientist-tools/pega-datascientist-tools/python/docs/source/articles/../../../pdstools/plots/plot_base.py:400</span>, in <span class="ansi-cyan-fg">Plots.plotPerformanceSuccessRateBubbleChart</span><span class="ansi-blue-fg">(self, last, add_bottom_left_text, query, facets, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    390</span> df, facets <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_subset_data(
<span class="ansi-green-intense-fg ansi-bold">    391</span>     table<span style="color: rgb(98,98,98)">=</span>table,
<span class="ansi-green-intense-fg ansi-bold">    392</span>     required_columns<span style="color: rgb(98,98,98)">=</span>required_columns,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    395</span>     last<span style="color: rgb(98,98,98)">=</span>last,
<span class="ansi-green-intense-fg ansi-bold">    396</span> )
<span class="ansi-green-intense-fg ansi-bold">    397</span> df <span style="color: rgb(98,98,98)">=</span> df<span style="color: rgb(98,98,98)">.</span>with_columns(
<span class="ansi-green-intense-fg ansi-bold">    398</span>     (pl<span style="color: rgb(98,98,98)">.</span>col([<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Performance</span><span style="color: rgb(175,0,0)">&#34;</span>]) <span style="color: rgb(98,98,98)">*</span> pl<span style="color: rgb(98,98,98)">.</span>lit(<span style="color: rgb(98,98,98)">100</span>))<span style="color: rgb(98,98,98)">.</span>round(kwargs<span style="color: rgb(98,98,98)">.</span>pop(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">round</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(98,98,98)">5</span>))
<span class="ansi-green-intense-fg ansi-bold">    399</span> )
<span class="ansi-green-fg">--&gt; 400</span> df <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">df</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">collect</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    401</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> kwargs<span style="color: rgb(98,98,98)">.</span>pop(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">return_df</span><span style="color: rgb(175,0,0)">&#34;</span>, <span class="ansi-bold" style="color: rgb(0,135,0)">False</span>):
<span class="ansi-green-intense-fg ansi-bold">    402</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> df

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/polars/lazyframe/frame.py:1816</span>, in <span class="ansi-cyan-fg">LazyFrame.collect</span><span class="ansi-blue-fg">(self, type_coercion, predicate_pushdown, projection_pushdown, simplify_expression, slice_pushdown, comm_subplan_elim, comm_subexpr_elim, no_optimization, streaming, background, _eager, **_kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1813</span> <span style="color: rgb(95,135,135)"># Only for testing purposes atm.</span>
<span class="ansi-green-intense-fg ansi-bold">   1814</span> callback <span style="color: rgb(98,98,98)">=</span> _kwargs<span style="color: rgb(98,98,98)">.</span>get(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">post_opt_callback</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-fg">-&gt; 1816</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> wrap_df(<span class="ansi-yellow-bg">ldf</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">collect</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">callback</span><span class="ansi-yellow-bg">)</span>)

<span class="ansi-red-fg">InvalidOperationError</span>: could not determine supertype of: [datetime[ns], dyn int]


This error occurred with the following context stack:
        [1] &#39;filter&#39; failed
        [2] &#39;select&#39; input failed to resolve
        [3] &#39;with_columns&#39; input failed to resolve
        [4] &#39;with_columns&#39; input failed to resolve

</pre></div></div>
</div>
<p>Or we can look at temporal filters, like only looking at the first snapshot:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm</span><span class="o">.</span><span class="n">plotPerformanceSuccessRateBubbleChart</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;SnapshotTime&#39;</span><span class="p">)</span><span class="o">==</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;SnapshotTime&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">InvalidOperationError</span>                     Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[19], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">dm</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">plotPerformanceSuccessRateBubbleChart</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">query</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">pl</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">col</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">SnapshotTime</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">==</span><span class="ansi-yellow-bg">pl</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">col</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">SnapshotTime</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">min</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/work/pega-datascientist-tools/pega-datascientist-tools/python/docs/source/articles/../../../pdstools/plots/plot_base.py:400</span>, in <span class="ansi-cyan-fg">Plots.plotPerformanceSuccessRateBubbleChart</span><span class="ansi-blue-fg">(self, last, add_bottom_left_text, query, facets, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    390</span> df, facets <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_subset_data(
<span class="ansi-green-intense-fg ansi-bold">    391</span>     table<span style="color: rgb(98,98,98)">=</span>table,
<span class="ansi-green-intense-fg ansi-bold">    392</span>     required_columns<span style="color: rgb(98,98,98)">=</span>required_columns,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    395</span>     last<span style="color: rgb(98,98,98)">=</span>last,
<span class="ansi-green-intense-fg ansi-bold">    396</span> )
<span class="ansi-green-intense-fg ansi-bold">    397</span> df <span style="color: rgb(98,98,98)">=</span> df<span style="color: rgb(98,98,98)">.</span>with_columns(
<span class="ansi-green-intense-fg ansi-bold">    398</span>     (pl<span style="color: rgb(98,98,98)">.</span>col([<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Performance</span><span style="color: rgb(175,0,0)">&#34;</span>]) <span style="color: rgb(98,98,98)">*</span> pl<span style="color: rgb(98,98,98)">.</span>lit(<span style="color: rgb(98,98,98)">100</span>))<span style="color: rgb(98,98,98)">.</span>round(kwargs<span style="color: rgb(98,98,98)">.</span>pop(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">round</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(98,98,98)">5</span>))
<span class="ansi-green-intense-fg ansi-bold">    399</span> )
<span class="ansi-green-fg">--&gt; 400</span> df <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">df</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">collect</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    401</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> kwargs<span style="color: rgb(98,98,98)">.</span>pop(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">return_df</span><span style="color: rgb(175,0,0)">&#34;</span>, <span class="ansi-bold" style="color: rgb(0,135,0)">False</span>):
<span class="ansi-green-intense-fg ansi-bold">    402</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> df

File <span class="ansi-green-fg">/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/polars/lazyframe/frame.py:1816</span>, in <span class="ansi-cyan-fg">LazyFrame.collect</span><span class="ansi-blue-fg">(self, type_coercion, predicate_pushdown, projection_pushdown, simplify_expression, slice_pushdown, comm_subplan_elim, comm_subexpr_elim, no_optimization, streaming, background, _eager, **_kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1813</span> <span style="color: rgb(95,135,135)"># Only for testing purposes atm.</span>
<span class="ansi-green-intense-fg ansi-bold">   1814</span> callback <span style="color: rgb(98,98,98)">=</span> _kwargs<span style="color: rgb(98,98,98)">.</span>get(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">post_opt_callback</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-fg">-&gt; 1816</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> wrap_df(<span class="ansi-yellow-bg">ldf</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">collect</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">callback</span><span class="ansi-yellow-bg">)</span>)

<span class="ansi-red-fg">InvalidOperationError</span>: could not determine supertype of: [datetime[ns], dyn int]


This error occurred with the following context stack:
        [1] &#39;filter&#39; failed
        [2] &#39;select&#39; input failed to resolve
        [3] &#39;with_columns&#39; input failed to resolve
        [4] &#39;with_columns&#39; input failed to resolve

</pre></div></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../autoapi/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">API Reference</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../reference.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Additional References</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Pegasystems
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/pegasystems/pega-datascientist-tools" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">pdstools version 3: Polars</a><ul>
<li><a class="reference internal" href="#Lazy-execution-graphs">Lazy execution graphs</a></li>
<li><a class="reference internal" href="#Lazy-vs-Eager">Lazy vs Eager</a><ul>
<li><a class="reference internal" href="#When-to-use-which?">When to use which?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#File-Types">File Types</a></li>
<li><a class="reference internal" href="#Further-Polars-examples">Further Polars examples</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=b21de401"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=4e2eecee"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>